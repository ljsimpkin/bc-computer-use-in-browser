!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios"),require("bitcoinsource")):"function"==typeof define&&define.amd?define(["exports","axios","bitcoinsource"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).computer={},e.axios,e.BitcoinSource)}(this,(function(e,t,r){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(t);var i=n(r);
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function u(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function a(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{s(n.next(e))}catch(e){i(e)}}function a(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}s((n=n.apply(e,t||[])).next())}))}const s=process.env.BC_CHAIN||"BSV";const c=process.env.BC_NETWORK||"testnet";const l=process.env.BC_WOC_API_KEY;const f=parseInt(process.env.BC_DUST_LIMIT||"",10)||4e3;const d=parseInt(process.env.BC_DEFAULT_FEE||"",10)||("BSV"===s?500:2500);const h=parseInt(process.env.BC_SCRIPT_CHUNK_SIZE||"",10)||479;let p;let v;process.env.BC_BBS_URL?(p=process.env.BC_BBS_URL,v=`ws${process.env.BC_BBS_URL.slice(4)}`):(p="https://bbs.bitcoincomputer.io",v="wss://bbs.bitcoincomputer.io");var y={CHAIN:s,NETWORK:c,WOC_API_KEY:l,MIN_NON_DUST_AMOUNT:f,SCRIPT_CHUNK_SIZE:h,UN_P2SH_URL:p,WS_URL:v,DEFAULT_FEE:d};i.default.versionGuard=()=>!0,i.default.Networks.defaultNetwork=i.default.Networks[y.NETWORK];class b extends i.default.Address{constructor(...e){super(...e)}}class w extends i.default.crypto.BN{constructor(...e){super(...e)}}class _ extends i.default.encoding.BufferReader{constructor(...e){super(...e)}}class g extends i.default.encoding.BufferWriter{constructor(...e){super(...e)}}class m extends i.default.Mnemonic{constructor(...e){super(...e)}}class A extends i.default.HDPrivateKey{constructor(...e){super(...e)}}class E extends i.default.Transaction.Input.MultiSigScriptHash{constructor(...e){super(...e)}}class O extends i.default.Script.Interpreter{constructor(...e){super(...e)}}class S extends i.default.Opcode{constructor(...e){super(...e)}}class j extends i.default.Transaction.Input{constructor(...e){super(...e)}}class D extends i.default.Transaction.Output{constructor(...e){super(...e)}}class x extends i.default.PrivateKey{constructor(...e){super(...e)}}class B extends i.default.PublicKey{constructor(...e){super(...e)}}class C extends i.default.Script{constructor(...e){super(...e)}}class F extends i.default.Transaction{constructor(...e){super(...e)}}function I(e){try{const t=JSON.parse(e);if("object"!=typeof t)throw new Error("Invalid object");if("string"!=typeof t.txhex)throw new Error("Invalid object");return new F(t.txhex)}catch(e){return null}}function T(e){return a(this,void 0,void 0,(function*(){const{message:t,config:{url:r,method:n,data:o},response:i}=e;const u=I(o);const a=`message\t${t}`;const s=`request\t${n} ${r}`;const c=u?`transaction\t ${JSON.stringify(u.toJSON(),null,2)}`:"";const l="post"===n?`data\t${o}`:"";const f=i?`response\t${JSON.stringify(i.data)}`:"";const d=u?c:l;throw e.message=`\n    Communication Error\n    ${a}\n    ${s}\n    ${d}\n    ${f}`,e}))}class P{constructor(e,t={}){this.baseUrl=e,this.headers=t}get(e){return a(this,void 0,void 0,(function*(){const t=`${this.baseUrl}${e}`;try{return(yield o.default.get(t,{headers:this.headers})).data}catch(e){return T(e)}}))}post(e,t){return a(this,void 0,void 0,(function*(){const r=`${this.baseUrl}${e}`;try{return(yield o.default.post(r,t,{headers:this.headers})).data}catch(e){return T(e)}}))}}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function R(e){var t={exports:{}};return e(t,t.exports),t.exports}function k(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}!function(e,t){if(!e.setImmediate){var r=1;var n={};var o=!1;var i=e.document;var u;var a=Object.getPrototypeOf&&Object.getPrototypeOf(e);var s;var c;var l,f;a=a&&a.setTimeout?a:e,"[object process]"==={}.toString.call(e.process)?u=function(e){process.nextTick((function(){h(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0;var r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(l="setImmediate$"+Math.random()+"$",f=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(l)&&h(+t.data.slice(l.length))},e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),u=function(t){e.postMessage(l+t,"*")}):e.MessageChannel?((c=new MessageChannel).port1.onmessage=function(e){h(e.data)},u=function(e){c.port2.postMessage(e)}):i&&"onreadystatechange"in i.createElement("script")?(s=i.documentElement,u=function(e){var t=i.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):u=function(e){setTimeout(h,0,e)},a.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));var t=new Array(arguments.length-1);for(var o=0;o<t.length;o++)t[o]=arguments[o+1];var i={callback:e,args:t};return n[r]=i,u(r),r++},a.clearImmediate=d}function d(e){delete n[e]}function h(e){if(o)setTimeout(h,0,e);else{var t=n[e];if(t){o=!0;try{!function(e){var t=e.callback;var r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{d(e),o=!1}}}}}("undefined"==typeof self?N:self);var M=N&&N.__extends||(U=function(e,t){return(U=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}U(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});var U;var $={AbortError:"A request was aborted, for example through a call to IDBTransaction.abort.",ConstraintError:"A mutation operation in the transaction failed because a constraint was not satisfied. For example, an object such as an object store or index already exists and a request attempted to create a new one.",DataCloneError:"The data being stored could not be cloned by the internal structured cloning algorithm.",DataError:"Data provided to an operation does not meet requirements.",InvalidAccessError:"An invalid operation was performed on an object. For example transaction creation attempt was made, but an empty scope was provided.",InvalidStateError:"An operation was called on an object on which it is not allowed or at a time when it is not allowed. Also occurs if a request is made on a source object that has been deleted or removed. Use TransactionInactiveError or ReadOnlyError when possible, as they are more specific variations of InvalidStateError.",NotFoundError:"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened.",ReadOnlyError:'The mutating operation was attempted in a "readonly" transaction.',TransactionInactiveError:"A request was placed against a transaction which is currently not active, or which is finished.",VersionError:"An attempt was made to open a database using a lower version than the existing version."};var K=function(e){function t(t){void 0===t&&(t=$.AbortError);var r=e.call(this)||this;return r.name="AbortError",r.message=t,r}return M(t,e),t}(Error);var V=K;var q=function(e){function t(t){void 0===t&&(t=$.ConstraintError);var r=e.call(this)||this;return r.name="ConstraintError",r.message=t,r}return M(t,e),t}(Error);var L=q;var H=function(e){function t(t){void 0===t&&(t=$.DataCloneError);var r=e.call(this)||this;return r.name="DataCloneError",r.message=t,r}return M(t,e),t}(Error);var W=H;var G=function(e){function t(t){void 0===t&&(t=$.DataError);var r=e.call(this)||this;return r.name="DataError",r.message=t,r}return M(t,e),t}(Error);var J=G;var z=function(e){function t(t){void 0===t&&(t=$.InvalidAccessError);var r=e.call(this)||this;return r.name="InvalidAccessError",r.message=t,r}return M(t,e),t}(Error);var Y=z;var Z=function(e){function t(t){void 0===t&&(t=$.InvalidStateError);var r=e.call(this)||this;return r.name="InvalidStateError",r.message=t,r}return M(t,e),t}(Error);var X=Z;var Q=function(e){function t(t){void 0===t&&(t=$.NotFoundError);var r=e.call(this)||this;return r.name="NotFoundError",r.message=t,r}return M(t,e),t}(Error);var ee=Q;var te=function(e){function t(t){void 0===t&&(t=$.ReadOnlyError);var r=e.call(this)||this;return r.name="ReadOnlyError",r.message=t,r}return M(t,e),t}(Error);var re=te;var ne=function(e){function t(t){void 0===t&&(t=$.TransactionInactiveError);var r=e.call(this)||this;return r.name="TransactionInactiveError",r.message=t,r}return M(t,e),t}(Error);var oe=ne;var ie=function(e){function t(t){void 0===t&&(t=$.VersionError);var r=e.call(this)||this;return r.name="VersionError",r.message=t,r}return M(t,e),t}(Error);var ue=ie;var ae=Object.defineProperty({AbortError:V,ConstraintError:L,DataCloneError:W,DataError:J,InvalidAccessError:Y,InvalidStateError:X,NotFoundError:ee,ReadOnlyError:re,TransactionInactiveError:oe,VersionError:ue},"__esModule",{value:!0});var se=function(e,t){if("number"==typeof e){if(isNaN(e))throw new ae.DataError;return e}if(e instanceof Date){var r=e.valueOf();if(isNaN(r))throw new ae.DataError;return new Date(r)}if("string"==typeof e)return e;if(e instanceof ArrayBuffer||"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e))return e instanceof ArrayBuffer?new Uint8Array(e).buffer:new Uint8Array(e.buffer).buffer;if(Array.isArray(e)){if(void 0===t)t=new Set;else if(t.has(e))throw new ae.DataError;t.add(e);var n=[];for(var o=0;o<e.length;o++){if(!e.hasOwnProperty(o))throw new ae.DataError;var i=e[o];var u=se(i,t);n.push(u)}return n}throw new ae.DataError};var ce=se;var le=Object.defineProperty({default:ce},"__esModule",{value:!0});var fe=function(e){if("number"==typeof e)return"Number";if(e instanceof Date)return"Date";if(Array.isArray(e))return"Array";if("string"==typeof e)return"String";if(e instanceof ArrayBuffer)return"Binary";throw new ae.DataError};var de=function(e,t){if(void 0===t)throw new TypeError;e=le.default(e),t=le.default(t);var r=fe(e);var n=fe(t);if(r!==n)return"Array"===r?1:("Binary"!==r||"String"!==n&&"Date"!==n&&"Number"!==n)&&("String"!==r||"Date"!==n&&"Number"!==n)?"Date"===r&&"Number"===n?1:-1:1;if("Binary"===r&&(e=new Uint8Array(e),t=new Uint8Array(t)),"Array"===r||"Binary"===r){var o=Math.min(e.length,t.length);for(var i=0;i<o;i++){var u=de(e[i],t[i]);if(0!==u)return u}return e.length>t.length?1:e.length<t.length?-1:0}if("Date"===r){if(e.getTime()===t.getTime())return 0}else if(e===t)return 0;return e>t?1:-1};var he=de;var pe=Object.defineProperty({default:he},"__esModule",{value:!0});var ve=function(){function e(e,t,r,n){this.lower=e,this.upper=t,this.lowerOpen=r,this.upperOpen=n}return e.only=function(t){if(0===arguments.length)throw new TypeError;return new e(t=le.default(t),t,!1,!1)},e.lowerBound=function(t,r){if(void 0===r&&(r=!1),0===arguments.length)throw new TypeError;return new e(t=le.default(t),void 0,r,!0)},e.upperBound=function(t,r){if(void 0===r&&(r=!1),0===arguments.length)throw new TypeError;return new e(void 0,t=le.default(t),!0,r)},e.bound=function(t,r,n,o){if(void 0===n&&(n=!1),void 0===o&&(o=!1),arguments.length<2)throw new TypeError;var i=pe.default(t,r);if(1===i||0===i&&(n||o))throw new ae.DataError;return new e(t=le.default(t),r=le.default(r),n,o)},e.prototype.includes=function(e){if(0===arguments.length)throw new TypeError;return e=le.default(e),!(void 0!==this.lower&&(1===(t=pe.default(this.lower,e))||0===t&&this.lowerOpen)||void 0!==this.upper&&(-1===(t=pe.default(this.upper,e))||0===t&&this.upperOpen));var t},e.prototype.toString=function(){return"[object IDBKeyRange]"},e}();var ye=ve;var be=Object.defineProperty({default:ye},"__esModule",{value:!0});var we=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var _e=function(e,t){var r,n;if(Array.isArray(e)){var o=[];try{for(var i=we(e),u=i.next();!u.done;u=i.next()){var a=u.value;null!=a&&"string"!=typeof a&&a.toString&&(a=a.toString()),o.push(le.default(_e(a,t)))}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o}if(""===e)return t;var s=e;var c=t;for(;null!==s;){var l=void 0;var f=s.indexOf(".");if(f>=0?(l=s.slice(0,f),s=s.slice(f+1)):(l=s,s=null),!c.hasOwnProperty(l))return;c=c[l]}return c};var ge=_e;var me=Object.defineProperty({default:ge},"__esModule",{value:!0});var Ae=R((function(e,t){e.exports=function e(t,r,n){function o(u,a){if(!r[u]){if(!t[u]){var s="function"==typeof k&&k;if(!a&&s)return s(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[u]={exports:{}};t[u][0].call(l.exports,(function(e){return o(t[u][1][e]||e)}),l,l.exports,e,t,r,n)}return r[u].exports}var i="function"==typeof k&&k;for(var u=0;u<n.length;u++)o(n[u]);return o}({1:[function(e,t,r){e("core-js/fn/array/includes"),e("core-js/fn/object/values");var n=e("domexception");var o=e("typeson");var i=e("typeson-registry/dist/presets/structured-cloning-throwing");var u="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope?self:void 0!==N?N:Function("return this;")();u.DOMException||(u.DOMException=n);var a=(new o).register(i);t.exports=function(e){return a.revive(a.encapsulate(e))}},{"core-js/fn/array/includes":2,"core-js/fn/object/values":3,domexception:44,typeson:47,"typeson-registry/dist/presets/structured-cloning-throwing":46}],2:[function(e,t,r){e("../../modules/es7.array.includes"),t.exports=e("../../modules/_core").Array.includes},{"../../modules/_core":9,"../../modules/es7.array.includes":39}],3:[function(e,t,r){e("../../modules/es7.object.values"),t.exports=e("../../modules/_core").Object.values},{"../../modules/_core":9,"../../modules/es7.object.values":40}],4:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],5:[function(e,t,r){var n=e("./_wks")("unscopables");var o=Array.prototype;null==o[n]&&e("./_hide")(o,n,{}),t.exports=function(e){o[n][e]=!0}},{"./_hide":19,"./_wks":38}],6:[function(e,t,r){var n=e("./_is-object");t.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":22}],7:[function(e,t,r){var n=e("./_to-iobject");var o=e("./_to-length");var i=e("./_to-absolute-index");t.exports=function(e){return function(t,r,u){var a=n(t);var s=o(a.length);var c=i(u,s);var l;if(e&&r!=r){for(;s>c;)if((l=a[c++])!=l)return!0}else for(;s>c;c++)if((e||c in a)&&a[c]===r)return e||c||0;return!e&&-1}}},{"./_to-absolute-index":32,"./_to-iobject":34,"./_to-length":35}],8:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],9:[function(e,t,r){var n=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=n)},{}],10:[function(e,t,r){var n=e("./_a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":4}],11:[function(e,t,r){t.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},{}],12:[function(e,t,r){t.exports=!e("./_fails")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},{"./_fails":16}],13:[function(e,t,r){var n=e("./_is-object");var o=e("./_global").document;var i=n(o)&&n(o.createElement);t.exports=function(e){return i?o.createElement(e):{}}},{"./_global":17,"./_is-object":22}],14:[function(e,t,r){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},{}],15:[function(e,t,r){var n=e("./_global");var o=e("./_core");var i=e("./_hide");var u=e("./_redefine");var a=e("./_ctx");var s=function e(t,r,s){var c=t&e.F;var l=t&e.G;var f=t&e.P;var d=t&e.B;var h=l?n:t&e.S?n[r]||(n[r]={}):(n[r]||{}).prototype;var p=l?o:o[r]||(o[r]={});var v=p.prototype||(p.prototype={});var y,b,w,_;for(y in l&&(s=r),s)w=((b=!c&&h&&void 0!==h[y])?h:s)[y],_=d&&b?a(w,n):f&&"function"==typeof w?a(Function.call,w):w,h&&u(h,y,w,t&e.U),p[y]!=w&&i(p,y,_),f&&v[y]!=w&&(v[y]=w)};n.core=o,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},{"./_core":9,"./_ctx":10,"./_global":17,"./_hide":19,"./_redefine":29}],16:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],17:[function(e,t,r){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},{}],18:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],19:[function(e,t,r){var n=e("./_object-dp");var o=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},{"./_descriptors":12,"./_object-dp":23,"./_property-desc":28}],20:[function(e,t,r){t.exports=!e("./_descriptors")&&!e("./_fails")((function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a}))},{"./_descriptors":12,"./_dom-create":13,"./_fails":16}],21:[function(e,t,r){var n=e("./_cof");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},{"./_cof":8}],22:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exports=function(e){return"object"===(void 0===e?"undefined":n(e))?null!==e:"function"==typeof e}},{}],23:[function(e,t,r){var n=e("./_an-object");var o=e("./_ie8-dom-define");var i=e("./_to-primitive");var u=Object.defineProperty;r.f=e("./_descriptors")?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return u(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},{"./_an-object":6,"./_descriptors":12,"./_ie8-dom-define":20,"./_to-primitive":36}],24:[function(e,t,r){var n=e("./_has");var o=e("./_to-iobject");var i=e("./_array-includes")(!1);var u=e("./_shared-key")("IE_PROTO");t.exports=function(e,t){var r=o(e);var a=0;var s=[];var c;for(c in r)c!=u&&n(r,c)&&s.push(c);for(;t.length>a;)n(r,c=t[a++])&&(~i(s,c)||s.push(c));return s}},{"./_array-includes":7,"./_has":18,"./_shared-key":30,"./_to-iobject":34}],25:[function(e,t,r){var n=e("./_object-keys-internal");var o=e("./_enum-bug-keys");t.exports=Object.keys||function(e){return n(e,o)}},{"./_enum-bug-keys":14,"./_object-keys-internal":24}],26:[function(e,t,r){r.f={}.propertyIsEnumerable},{}],27:[function(e,t,r){var n=e("./_object-keys");var o=e("./_to-iobject");var i=e("./_object-pie").f;t.exports=function(e){return function(t){var r=o(t);var u=n(r);var a=u.length;var s=0;var c=[];var l;for(;a>s;)i.call(r,l=u[s++])&&c.push(e?[l,r[l]]:r[l]);return c}}},{"./_object-keys":25,"./_object-pie":26,"./_to-iobject":34}],28:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],29:[function(e,t,r){var n=e("./_global");var o=e("./_hide");var i=e("./_has");var u=e("./_uid")("src");var a="toString";var s=Function.toString;var c=(""+s).split(a);e("./_core").inspectSource=function(e){return s.call(e)},(t.exports=function(e,t,r,a){var s="function"==typeof r;s&&(i(r,"name")||o(r,"name",t)),e[t]!==r&&(s&&(i(r,u)||o(r,u,e[t]?""+e[t]:c.join(String(t)))),e===n?e[t]=r:a?e[t]?e[t]=r:o(e,t,r):(delete e[t],o(e,t,r)))})(Function.prototype,a,(function(){return"function"==typeof this&&this[u]||s.call(this)}))},{"./_core":9,"./_global":17,"./_has":18,"./_hide":19,"./_uid":37}],30:[function(e,t,r){var n=e("./_shared")("keys");var o=e("./_uid");t.exports=function(e){return n[e]||(n[e]=o(e))}},{"./_shared":31,"./_uid":37}],31:[function(e,t,r){var n=e("./_global");var o="__core-js_shared__";var i=n[o]||(n[o]={});t.exports=function(e){return i[e]||(i[e]={})}},{"./_global":17}],32:[function(e,t,r){var n=e("./_to-integer");var o=Math.max;var i=Math.min;t.exports=function(e,t){return(e=n(e))<0?o(e+t,0):i(e,t)}},{"./_to-integer":33}],33:[function(e,t,r){var n=Math.ceil;var o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},{}],34:[function(e,t,r){var n=e("./_iobject");var o=e("./_defined");t.exports=function(e){return n(o(e))}},{"./_defined":11,"./_iobject":21}],35:[function(e,t,r){var n=e("./_to-integer");var o=Math.min;t.exports=function(e){return e>0?o(n(e),9007199254740991):0}},{"./_to-integer":33}],36:[function(e,t,r){var n=e("./_is-object");t.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":22}],37:[function(e,t,r){var n=0;var o=Math.random();t.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},{}],38:[function(e,t,r){var n=e("./_shared")("wks");var o=e("./_uid");var i=e("./_global").Symbol;var u="function"==typeof i;(t.exports=function(e){return n[e]||(n[e]=u&&i[e]||(u?i:o)("Symbol."+e))}).store=n},{"./_global":17,"./_shared":31,"./_uid":37}],39:[function(e,t,r){var n=e("./_export");var o=e("./_array-includes")(!0);n(n.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),e("./_add-to-unscopables")("includes")},{"./_add-to-unscopables":5,"./_array-includes":7,"./_export":15}],40:[function(e,t,r){var n=e("./_export");var o=e("./_object-to-array")(!1);n(n.S,"Object",{values:function(e){return o(e)}})},{"./_export":15,"./_object-to-array":27}],41:[function(e,t,r){var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=e("./legacy-error-codes.json");var i=e("./utils.js");r.implementation=function(){function e(t){var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[];var n=!0;var o=!1;var i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),2!==r.length);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return r}(e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(t),n=r[0],o=r[1];(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.name=o,this.message=n}return n(e,[{key:"code",get:function(){return o[this.name]||0}}]),e}(),r.init=function(e){if(Error.captureStackTrace){var t=i.wrapperForImpl(e);Error.captureStackTrace(t,t.constructor)}}},{"./legacy-error-codes.json":43,"./utils.js":45}],42:[function(e,t,r){var n=e("webidl-conversions");var o=e("./utils.js");var i=o.implSymbol;function u(){var e=[];for(var t=0;t<arguments.length&&t<2;++t)e[t]=arguments[t];void 0!==e[0]?e[0]=n.DOMString(e[0],{context:"Failed to construct 'DOMException': parameter 1"}):e[0]="",void 0!==e[1]?e[1]=n.DOMString(e[1],{context:"Failed to construct 'DOMException': parameter 2"}):e[1]="Error",a.setup(this,e)}Object.defineProperty(u,"prototype",{value:u.prototype,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(u.prototype,"name",{get:function(){return this[i].name},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"message",{get:function(){return this[i].message},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"code",{get:function(){return this[i].code},enumerable:!0,configurable:!0}),Object.defineProperty(u,"INDEX_SIZE_ERR",{value:1,enumerable:!0}),Object.defineProperty(u.prototype,"INDEX_SIZE_ERR",{value:1,enumerable:!0}),Object.defineProperty(u,"DOMSTRING_SIZE_ERR",{value:2,enumerable:!0}),Object.defineProperty(u.prototype,"DOMSTRING_SIZE_ERR",{value:2,enumerable:!0}),Object.defineProperty(u,"HIERARCHY_REQUEST_ERR",{value:3,enumerable:!0}),Object.defineProperty(u.prototype,"HIERARCHY_REQUEST_ERR",{value:3,enumerable:!0}),Object.defineProperty(u,"WRONG_DOCUMENT_ERR",{value:4,enumerable:!0}),Object.defineProperty(u.prototype,"WRONG_DOCUMENT_ERR",{value:4,enumerable:!0}),Object.defineProperty(u,"INVALID_CHARACTER_ERR",{value:5,enumerable:!0}),Object.defineProperty(u.prototype,"INVALID_CHARACTER_ERR",{value:5,enumerable:!0}),Object.defineProperty(u,"NO_DATA_ALLOWED_ERR",{value:6,enumerable:!0}),Object.defineProperty(u.prototype,"NO_DATA_ALLOWED_ERR",{value:6,enumerable:!0}),Object.defineProperty(u,"NO_MODIFICATION_ALLOWED_ERR",{value:7,enumerable:!0}),Object.defineProperty(u.prototype,"NO_MODIFICATION_ALLOWED_ERR",{value:7,enumerable:!0}),Object.defineProperty(u,"NOT_FOUND_ERR",{value:8,enumerable:!0}),Object.defineProperty(u.prototype,"NOT_FOUND_ERR",{value:8,enumerable:!0}),Object.defineProperty(u,"NOT_SUPPORTED_ERR",{value:9,enumerable:!0}),Object.defineProperty(u.prototype,"NOT_SUPPORTED_ERR",{value:9,enumerable:!0}),Object.defineProperty(u,"INUSE_ATTRIBUTE_ERR",{value:10,enumerable:!0}),Object.defineProperty(u.prototype,"INUSE_ATTRIBUTE_ERR",{value:10,enumerable:!0}),Object.defineProperty(u,"INVALID_STATE_ERR",{value:11,enumerable:!0}),Object.defineProperty(u.prototype,"INVALID_STATE_ERR",{value:11,enumerable:!0}),Object.defineProperty(u,"SYNTAX_ERR",{value:12,enumerable:!0}),Object.defineProperty(u.prototype,"SYNTAX_ERR",{value:12,enumerable:!0}),Object.defineProperty(u,"INVALID_MODIFICATION_ERR",{value:13,enumerable:!0}),Object.defineProperty(u.prototype,"INVALID_MODIFICATION_ERR",{value:13,enumerable:!0}),Object.defineProperty(u,"NAMESPACE_ERR",{value:14,enumerable:!0}),Object.defineProperty(u.prototype,"NAMESPACE_ERR",{value:14,enumerable:!0}),Object.defineProperty(u,"INVALID_ACCESS_ERR",{value:15,enumerable:!0}),Object.defineProperty(u.prototype,"INVALID_ACCESS_ERR",{value:15,enumerable:!0}),Object.defineProperty(u,"VALIDATION_ERR",{value:16,enumerable:!0}),Object.defineProperty(u.prototype,"VALIDATION_ERR",{value:16,enumerable:!0}),Object.defineProperty(u,"TYPE_MISMATCH_ERR",{value:17,enumerable:!0}),Object.defineProperty(u.prototype,"TYPE_MISMATCH_ERR",{value:17,enumerable:!0}),Object.defineProperty(u,"SECURITY_ERR",{value:18,enumerable:!0}),Object.defineProperty(u.prototype,"SECURITY_ERR",{value:18,enumerable:!0}),Object.defineProperty(u,"NETWORK_ERR",{value:19,enumerable:!0}),Object.defineProperty(u.prototype,"NETWORK_ERR",{value:19,enumerable:!0}),Object.defineProperty(u,"ABORT_ERR",{value:20,enumerable:!0}),Object.defineProperty(u.prototype,"ABORT_ERR",{value:20,enumerable:!0}),Object.defineProperty(u,"URL_MISMATCH_ERR",{value:21,enumerable:!0}),Object.defineProperty(u.prototype,"URL_MISMATCH_ERR",{value:21,enumerable:!0}),Object.defineProperty(u,"QUOTA_EXCEEDED_ERR",{value:22,enumerable:!0}),Object.defineProperty(u.prototype,"QUOTA_EXCEEDED_ERR",{value:22,enumerable:!0}),Object.defineProperty(u,"TIMEOUT_ERR",{value:23,enumerable:!0}),Object.defineProperty(u.prototype,"TIMEOUT_ERR",{value:23,enumerable:!0}),Object.defineProperty(u,"INVALID_NODE_TYPE_ERR",{value:24,enumerable:!0}),Object.defineProperty(u.prototype,"INVALID_NODE_TYPE_ERR",{value:24,enumerable:!0}),Object.defineProperty(u,"DATA_CLONE_ERR",{value:25,enumerable:!0}),Object.defineProperty(u.prototype,"DATA_CLONE_ERR",{value:25,enumerable:!0}),Object.defineProperty(u.prototype,Symbol.toStringTag,{value:"DOMException",writable:!1,enumerable:!1,configurable:!0});var a={mixedInto:[],is:function(e){if(e){if(e[i]instanceof s.implementation)return!0;for(var r=0;r<t.exports.mixedInto.length;++r)if(e instanceof t.exports.mixedInto[r])return!0}return!1},isImpl:function(e){if(e){if(e instanceof s.implementation)return!0;var r=o.wrapperForImpl(e);for(var n=0;n<t.exports.mixedInto.length;++n)if(r instanceof t.exports.mixedInto[n])return!0}return!1},convert:function(e){var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).context,n=void 0===r?"The provided value":r;if(t.exports.is(e))return o.implForWrapper(e);throw new TypeError(n+" is not of type 'DOMException'.")},create:function(e,t){var r=Object.create(u.prototype);return this.setup(r,e,t),r},createImpl:function(e,t){var r=Object.create(u.prototype);return this.setup(r,e,t),o.implForWrapper(r)},_internalSetup:function(e){},setup:function(e,t,r){r||(r={}),r.wrapper=e,this._internalSetup(e),Object.defineProperty(e,i,{value:new s.implementation(t,r),writable:!1,enumerable:!1,configurable:!0}),e[i][o.wrapperSymbol]=e,s.init&&s.init(e[i],r)},interface:u,expose:{Window:{DOMException:u},Worker:{DOMException:u}}};t.exports=a;var s=e(".//DOMException-impl.js")},{".//DOMException-impl.js":41,"./utils.js":45,"webidl-conversions":48}],43:[function(e,t,r){t.exports={IndexSizeError:1,DOMStringSizeError:2,HierarchyRequestError:3,WrongDocumentError:4,InvalidCharacterError:5,NoDataAllowedError:6,NoModificationAllowedError:7,NotFoundError:8,NotSupportedError:9,InUseAttributeError:10,InvalidStateError:11,SyntaxError:12,InvalidModificationError:13,NamespaceError:14,InvalidAccessError:15,ValidationError:16,TypeMismatchError:17,SecurityError:18,NetworkError:19,AbortError:20,URLMismatchError:21,QuotaExceededError:22,TimeoutError:23,InvalidNodeTypeError:24,DataCloneError:25}},{}],44:[function(e,t,r){t.exports=e("./DOMException").interface,Object.setPrototypeOf(t.exports.prototype,Error.prototype)},{"./DOMException":42}],45:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e){return Object.getPrototypeOf(e)===Buffer.prototype?e:e instanceof ArrayBuffer?Buffer.from(e):Buffer.from(e.buffer,e.byteOffset,e.byteLength)}var i=Symbol("wrapper");var u=Symbol("impl");var a=Symbol("SameObject caches");function s(e){return e?e[i]:null}function c(e){return e?e[u]:null}var l=Symbol("internal");var f=Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]()));t.exports={isObject:function(e){return"object"===(void 0===e?"undefined":n(e))&&null!==e||"function"==typeof e},getReferenceToBytes:o,getCopyToBytes:function(e){return Buffer.from(o(e))},mixin:function(e,t){var r=Object.getOwnPropertyNames(t);for(var n=0;n<r.length;++n)r[n]in e||Object.defineProperty(e,r[n],Object.getOwnPropertyDescriptor(t,r[n]))},wrapperSymbol:i,implSymbol:u,getSameObject:function(e,t,r){return e[a]||(e[a]=Object.create(null)),t in e[a]||(e[a][t]=r()),e[a][t]},wrapperForImpl:s,implForWrapper:c,tryWrapperForImpl:function(e){return s(e)||e},tryImplForWrapper:function(e){return c(e)||e},iterInternalSymbol:l,IteratorPrototype:f}},{}],46:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var o,i;o=void 0,i=function(){var e="function"==typeof Symbol&&"symbol"==n(Symbol.iterator)?function(e){return void 0===e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":n(e)},t=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=Object.keys,o=Array.isArray,i={}.toString,u=Object.getPrototypeOf,a={}.hasOwnProperty,s=a.toString,c=["type","replaced","iterateIn","iterateUnsetNumeric"];function l(e,t){return v.isObject(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function f(e){return i.call(e).slice(8,-1)}function d(t,r){if(!t||"object"!==(void 0===t?"undefined":e(t)))return!1;var n=u(t);if(!n)return!1;var o=a.call(n,"constructor")&&n.constructor;return"function"!=typeof o?null===r:"function"==typeof o&&null!==r&&s.call(o)===s.call(r)}function h(e){return!(!e||"Object"!==f(e))&&(!u(e)||d(e,Object))}function p(t){return t&&"object"===(void 0===t?"undefined":e(t))}function v(n){var i=[],u=[],a={},s=this.types={},f=this.stringify=function(e,t,r,i){i=Object.assign({},n,i,{stringification:!0});var u=A(e,null,i);return o(u)?JSON.stringify(u[0],t,r):u.then((function(e){return JSON.stringify(e,t,r)}))};this.stringifySync=function(e,t,r,n){return f(e,t,r,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!0}))},this.stringifyAsync=function(e,t,r,n){return f(e,t,r,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!1}))};var w=this.parse=function(e,t,r){return r=Object.assign({},n,r,{parse:!0}),E(JSON.parse(e,t),r)};this.parseSync=function(e,t,r){return w(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!0}))},this.parseAsync=function(e,t,r){return w(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!1}))},this.specialTypeNames=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.returnTypeNames=!0,this.encapsulate(e,t,r)},this.rootTypeName=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.iterateNone=!0,this.encapsulate(e,t,r)};var A=this.encapsulate=function(s,l,f){var y=(f=Object.assign({sync:!0},n,f)).sync,w={},_=[],g=[],A=[],E=!(f&&"cyclic"in f)||f.cyclic,O=f.encapsulateObserver,S=x("",s,E,l||{},A);function j(e){var t=Object.values(w);if(f.iterateNone)return t.length?t[0]:v.getJSONType(e);if(t.length){if(f.returnTypeNames)return[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(new Set(t)));e&&h(e)&&!e.hasOwnProperty("$types")?e.$types=w:e={$:e,$types:{$:w}}}else p(e)&&e.hasOwnProperty("$types")&&(e={$:e,$types:!0});return!f.returnTypeNames&&e}return A.length?y&&f.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(function e(r,n){return Promise.all(n.map((function(e){return e[1].p}))).then((function(o){return Promise.all(o.map((function(o){var i=[],u=n.splice(0,1)[0],a=t(u,7),s=a[0],c=a[2],l=a[3],f=a[4],h=a[5],p=a[6],v=x(s,o,c,l,i,!0,p),y=d(v,m);return s&&y?v.p.then((function(t){return f[h]=t,e(r,i)})):(s?f[h]=v:r=y?v.p:v,e(r,i))})))})).then((function(){return r}))}(S,A)).then(j):!y&&f.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():f.stringification&&y?[j(S)]:y?j(S):Promise.resolve(j(S));function D(e,t,r){Object.assign(e,t);var n=c.map((function(t){var r=e[t];return delete e[t],r}));r(),c.forEach((function(t,r){e[t]=n[r]}))}function x(t,n,u,a,s,c,l){var p=void 0,y={},A=void 0===n?"undefined":e(n),E=O?function(e){var r=l||a.type||v.getJSONType(n);O(Object.assign(e||y,{keypath:t,value:n,cyclic:u,stateObj:a,promisesData:s,resolvingTypesonPromise:c,awaitingTypesonPromise:d(n,m)},void 0!==r?{type:r}:{}))}:null;if(A in{string:1,boolean:1,number:1,undefined:1})return void 0===n||"number"===A&&(isNaN(n)||n===-1/0||n===1/0)?(p=B(t,n,a,s,!1,c,E))!==n&&(y={replaced:p}):p=n,E&&E(),p;if(null===n)return E&&E(),n;if(u&&!a.iterateIn&&!a.iterateUnsetNumeric){var S=_.indexOf(n);if(!(S<0))return w[t]="#",E&&E({cyclicKeypath:g[S]}),"#"+g[S];!0===u&&(_.push(n),g.push(t))}var j=h(n),C=o(n),F=(j||C)&&(!i.length||a.replaced)||a.iterateIn?n:B(t,n,a,s,j||C,null,E),I=void 0;if(F!==n?(p=F,y={replaced:F}):C||"array"===a.iterateIn?(I=new Array(n.length),y={clone:I}):j||"object"===a.iterateIn?y={clone:I={}}:""===t&&d(n,m)?(s.push([t,n,u,a,void 0,void 0,a.type]),p=n):p=n,E&&E(),f.iterateNone)return I||p;if(!I)return p;if(a.iterateIn){var T=function(e){var r={ownKeys:n.hasOwnProperty(e)};D(a,r,(function(){var r=t+(t?".":"")+b(e),o=x(r,n[e],!!u,a,s,c);d(o,m)?s.push([r,o,!!u,a,I,e,a.type]):void 0!==o&&(I[e]=o)}))};for(var P in n)T(P);E&&E({endIterateIn:!0,end:!0})}else r(n).forEach((function(e){var r=t+(t?".":"")+b(e);D(a,{ownKeys:!0},(function(){var t=x(r,n[e],!!u,a,s,c);d(t,m)?s.push([r,t,!!u,a,I,e,a.type]):void 0!==t&&(I[e]=t)}))})),E&&E({endIterateOwn:!0,end:!0});if(a.iterateUnsetNumeric){for(var N=n.length,R=function(e){if(!(e in n)){var r=t+(t?".":"")+e;D(a,{ownKeys:!1},(function(){var t=x(r,void 0,!!u,a,s,c);d(t,m)?s.push([r,t,!!u,a,I,e,a.type]):void 0!==t&&(I[e]=t)}))}},k=0;k<N;k++)R(k);E&&E({endIterateUnsetNumeric:!0,end:!0})}return I}function B(e,t,r,n,o,s,c){for(var l=o?i:u,f=l.length;f--;){var d=l[f];if(d.test(t,r)){var h=d.type;if(a[h]){var p=w[e];w[e]=p?[h].concat(p):h}return Object.assign(r,{type:h,replaced:!0}),!y&&d.replaceAsync||d.replace?(c&&c({replacing:!0}),x(e,d[y||!d.replaceAsync?"replace":"replaceAsync"](t,r),E&&"readonly",r,n,s,h)):(c&&c({typeDetected:!0}),x(e,t,E&&"readonly",r,n,s,h))}}return t}};this.encapsulateSync=function(e,t,r){return A(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!0}))},this.encapsulateAsync=function(e,t,r){return A(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!1}))};var E=this.revive=function(e,i){var u=(i=Object.assign({sync:!0},n,i)).sync,s=e&&e.$types,c=!0;if(!s)return e;if(!0===s)return e.$;s.$&&h(s.$)&&(e=e.$,s=s.$,c=!1);var f=[],p={},v=function e(n,i,u,l,v,y){if(!c||"$types"!==n){var w=s[n];if(o(i)||h(i)){var m=o(i)?new Array(i.length):{};for(r(i).forEach((function(t){var r=e(n+(n?".":"")+b(t),i[t],u||m,l,m,t);d(r,g)?m[t]=void 0:void 0!==r&&(m[t]=r)})),i=m;f.length;){var A=t(f[0],4),E=A[0],O=A[1],S=A[2],j=A[3],D=_(E,O);if(d(D,g))S[j]=void 0;else{if(void 0===D)break;S[j]=D}f.splice(0,1)}}if(!w)return i;if("#"===w){var x=_(u,i.substr(1));return void 0===x&&f.push([u,i.substr(1),v,y]),x}var B=l.sync;return[].concat(w).reduce((function(e,t){var r=a[t];if(!r)throw new Error("Unregistered type: "+t);return r[B&&r.revive?"revive":!B&&r.reviveAsync?"reviveAsync":"revive"](e,p)}),i)}}("",e,null,i);return l(v=d(v,g)?void 0:v)?u&&i.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():v:!u&&i.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():u?v:Promise.resolve(v)};this.reviveSync=function(e,t){return E(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!0}))},this.reviveAsync=function(e,t){return E(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!1}))},this.register=function(e,t){return t=t||{},[].concat(e).forEach((function e(n){if(o(n))return n.map(e);n&&r(n).forEach((function(e){if("#"===e)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(v.JSON_TYPES.includes(e))throw new TypeError("Plain JSON object types are reserved as type names");var r=n[e],c=r.testPlainObjects?i:u,l=c.filter((function(t){return t.type===e}));if(l.length&&(c.splice(c.indexOf(l[0]),1),delete a[e],delete s[e]),r){if("function"==typeof r){var f=r;r={test:function(e){return e&&e.constructor===f},replace:function(e){return y({},e)},revive:function(e){return y(Object.create(f.prototype),e)}}}else o(r)&&(r={test:r[0],replace:r[1],revive:r[2]});var d={type:e,test:r.test.bind(r)};r.replace&&(d.replace=r.replace.bind(r)),r.replaceAsync&&(d.replaceAsync=r.replaceAsync.bind(r));var h="number"==typeof t.fallback?t.fallback:t.fallback?0:1/0;if(r.testPlainObjects?i.splice(h,0,d):u.splice(h,0,d),r.revive||r.reviveAsync){var p={};r.revive&&(p.revive=r.revive.bind(r)),r.reviveAsync&&(p.reviveAsync=r.reviveAsync.bind(r)),a[e]=p}s[e]=r}}))})),this}}function y(e,t){return r(t).map((function(r){e[r]=t[r]})),e}function b(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function w(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function _(e,t){if(""===t)return e;var r=t.indexOf(".");if(r>-1){var n=e[w(t.substr(0,r))];return void 0===n?void 0:_(n,t.substr(r+1))}return e[w(t)]}function g(){}function m(e){this.p=new Promise(e)}m.prototype.then=function(e,t){var r=this;return new m((function(n,o){r.p.then((function(t){n(e?e(t):t)}),(function(e){r.p.catch((function(e){return t?t(e):Promise.reject(e)})).then(n,o)}))}))},m.prototype.catch=function(e){return this.then(null,e)},m.resolve=function(e){return new m((function(t){t(e)}))},m.reject=function(e){return new m((function(t,r){r(e)}))},["all","race"].map((function(e){m[e]=function(t){return new m((function(r,n){Promise[e](t.map((function(e){return e.p}))).then(r,n)}))}})),v.Undefined=g,v.Promise=m,v.isThenable=l,v.toStringTag=f,v.hasConstructorOf=d,v.isObject=p,v.isPlainObject=h,v.isUserObject=function e(t){if(!t||"Object"!==f(t))return!1;var r=u(t);return!r||d(t,Object)||e(r)},v.escapeKeyPathComponent=b,v.unescapeKeyPathComponent=w,v.getByKeyPath=_,v.getJSONType=function(t){return null===t?"null":o(t)?"array":void 0===t?"undefined":e(t)},v.JSON_TYPES=["null","boolean","number","string","array","object"];for(var A={userObject:{test:function(e,t){return v.isUserObject(e)},replace:function(e){return Object.assign({},e)},revive:function(e){return e}}},E=[[{sparseArrays:{testPlainObjects:!0,test:function(e){return Array.isArray(e)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e}}},{sparseUndefined:{test:function(e,t){return void 0===e&&!1===t.ownKeys},replace:function(e){return null},revive:function(e){}}}],{undef:{test:function(e,t){return void 0===e&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return null},revive:function(e){return new v.Undefined}}}],O={StringObject:{test:function(t){return"String"===v.toStringTag(t)&&"object"===(void 0===t?"undefined":e(t))},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(t){return"Boolean"===v.toStringTag(t)&&"object"===(void 0===t?"undefined":e(t))},replace:function(e){return Boolean(e)},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(t){return"Number"===v.toStringTag(t)&&"object"===(void 0===t?"undefined":e(t))},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},S=[{nan:{test:function(e){return"number"==typeof e&&isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return NaN}}},{infinity:{test:function(e){return e===1/0},replace:function(e){return"Infinity"},revive:function(e){return 1/0}}},{negativeInfinity:{test:function(e){return e===-1/0},replace:function(e){return"-Infinity"},revive:function(e){return-1/0}}}],j={date:{test:function(e){return"Date"===v.toStringTag(e)},replace:function(e){var t=e.getTime();return isNaN(t)?"NaN":t},revive:function(e){return"NaN"===e?new Date(NaN):new Date(e)}}},D={regexp:{test:function(e){return"RegExp"===v.toStringTag(e)},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,r=e.flags;return new RegExp(t,r)}}},x={map:{test:function(e){return"Map"===v.toStringTag(e)},replace:function(e){return Array.from(e.entries())},revive:function(e){return new Map(e)}}},B={set:{test:function(e){return"Set"===v.toStringTag(e)},replace:function(e){return Array.from(e.values())},revive:function(e){return new Set(e)}}},C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",F=new Uint8Array(256),I=0;I<C.length;I++)F[C.charCodeAt(I)]=I;var T=function(e,t,r){for(var n=new Uint8Array(e,t,r),o=n.length,i="",u=0;u<o;u+=3)i+=C[n[u]>>2],i+=C[(3&n[u])<<4|n[u+1]>>4],i+=C[(15&n[u+1])<<2|n[u+2]>>6],i+=C[63&n[u+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},P=function(e){var t=e.length,r=.75*e.length,n=0,o=void 0,i=void 0,u=void 0,a=void 0;"="===e[e.length-1]&&(r--,"="===e[e.length-2]&&r--);for(var s=new ArrayBuffer(r),c=new Uint8Array(s),l=0;l<t;l+=4)o=F[e.charCodeAt(l)],i=F[e.charCodeAt(l+1)],u=F[e.charCodeAt(l+2)],a=F[e.charCodeAt(l+3)],c[n++]=o<<2|i>>4,c[n++]=(15&i)<<4|u>>2,c[n++]=(3&u)<<6|63&a;return s},R={arraybuffer:{test:function(e){return"ArrayBuffer"===v.toStringTag(e)},replace:function(e,t){t.buffers||(t.buffers=[]);var r=t.buffers.indexOf(e);return r>-1?{index:r}:(t.buffers.push(e),T(e))},revive:function(t,r){if(r.buffers||(r.buffers=[]),"object"===(void 0===t?"undefined":e(t)))return r.buffers[t.index];var n=P(t);return r.buffers.push(n),n}}},k="undefined"==typeof self?N:self,M={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach((function(e){var t=e,r=k[t];r&&(M[e.toLowerCase()]={test:function(e){return v.toStringTag(e)===t},replace:function(e,t){var r=e.buffer,n=e.byteOffset,o=e.length;t.buffers||(t.buffers=[]);var i=t.buffers.indexOf(r);return i>-1?{index:i,byteOffset:n,length:o}:(t.buffers.push(r),{encoded:T(r),byteOffset:n,length:o})},revive:function(e,t){t.buffers||(t.buffers=[]);var n=e.byteOffset,o=e.length,i=e.encoded,u=e.index,a=void 0;return"index"in e?a=t.buffers[u]:(a=P(i),t.buffers.push(a)),new r(a,n,o)}})}));var U={dataview:{test:function(e){return"DataView"===v.toStringTag(e)},replace:function(e,t){var r=e.buffer,n=e.byteOffset,o=e.byteLength;t.buffers||(t.buffers=[]);var i=t.buffers.indexOf(r);return i>-1?{index:i,byteOffset:n,byteLength:o}:(t.buffers.push(r),{encoded:T(r),byteOffset:n,byteLength:o})},revive:function(e,t){t.buffers||(t.buffers=[]);var r=e.byteOffset,n=e.byteLength,o=e.encoded,i=e.index,u=void 0;return"index"in e?u=t.buffers[i]:(u=P(o),t.buffers.push(u)),new DataView(u,r,n)}}},$={IntlCollator:{test:function(e){return v.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return v.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return v.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}},K={file:{test:function(e){return"File"===v.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.open("GET",URL.createObjectURL(e),!1),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return t.send(),{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,r=e.type,n=e.stringContents,o=e.lastModified;return new File([n],t,{type:r,lastModified:o})},replaceAsync:function(e){return new v.Promise((function(t,r){if(e.isClosed)r(new Error("The File is closed"));else{var n=new FileReader;n.addEventListener("load",(function(){t({type:e.type,stringContents:n.result,name:e.name,lastModified:e.lastModified})})),n.addEventListener("error",(function(){r(n.error)})),n.readAsText(e)}}))}}};return[A,E,O,S,j,D,{imagedata:{test:function(e){return"ImageData"===v.toStringTag(e)},replace:function(e){return{array:Array.from(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return"ImageBitmap"===v.toStringTag(e)||e&&e.dataset&&"ImageBitmap"===e.dataset.toStringTag},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),n=document.createElement("img");return n.onload=function(){r.drawImage(n,0,0)},n.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),r=t.getContext("2d"),n=document.createElement("img");return n.onload=function(){r.drawImage(n,0,0)},n.src=e,createImageBitmap(t)}}},K,{file:K.file,filelist:{test:function(e){return"FileList"===v.toStringTag(e)},replace:function(e){for(var t=[],r=0;r<e.length;r++)t[r]=e.item(r);return t},revive:function(e){function t(){this._files=arguments[0],this.length=this._files.length}return t.prototype.item=function(e){return this._files[e]},t.prototype[Symbol.toStringTag]="FileList",new t(e)}}},{blob:{test:function(e){return"Blob"===v.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.open("GET",URL.createObjectURL(e),!1),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return t.send(),{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,r=e.stringContents;return new Blob([r],{type:t})},replaceAsync:function(e){return new v.Promise((function(t,r){if(e.isClosed)r(new Error("The Blob is closed"));else{var n=new FileReader;n.addEventListener("load",(function(){t({type:e.type,stringContents:n.result})})),n.addEventListener("error",(function(){r(n.error)})),n.readAsText(e)}}))}}}].concat("function"==typeof Map?x:[],"function"==typeof Set?B:[],"function"==typeof ArrayBuffer?R:[],"function"==typeof Uint8Array?M:[],"function"==typeof DataView?U:[],"undefined"!=typeof Intl?$:[]).concat({checkDataCloneException:[function(t){var r={}.toString.call(t).slice(8,-1);if(["symbol","function"].includes(void 0===t?"undefined":e(t))||["Arguments","Module","Error","Promise","WeakMap","WeakSet"].includes(r)||t===Object.prototype||("Blob"===r||"File"===r)&&t.isClosed||t&&"object"===(void 0===t?"undefined":e(t))&&"number"==typeof t.nodeType&&"function"==typeof t.insertBefore)throw new DOMException("The object cannot be cloned.","DataCloneError");return!1}]})},"object"==(void 0===r?"undefined":n(r))&&void 0!==t?t.exports=i():(o.Typeson=o.Typeson||{},o.Typeson.presets=o.Typeson.presets||{},o.Typeson.presets.structuredCloningThrowing=i())},{}],47:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var o="function"==typeof Symbol&&"symbol"==n(Symbol.iterator)?function(e){return void 0===e?"undefined":n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":n(e)},i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var u,a=e[Symbol.iterator]();!(n=(u=a.next()).done)&&(r.push(u.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},u=Object.keys,a=Array.isArray,s={}.toString,c=Object.getPrototypeOf,l={}.hasOwnProperty,f=l.toString,d=["type","replaced","iterateIn","iterateUnsetNumeric"];function h(e,t){return w.isObject(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function p(e){return s.call(e).slice(8,-1)}function v(e,t){if(!e||"object"!==(void 0===e?"undefined":o(e)))return!1;var r=c(e);if(!r)return!1;var n=l.call(r,"constructor")&&r.constructor;return"function"!=typeof n?null===t:"function"==typeof n&&null!==t&&f.call(n)===f.call(t)}function y(e){return!(!e||"Object"!==p(e))&&(!c(e)||v(e,Object))}function b(e){return e&&"object"===(void 0===e?"undefined":o(e))}function w(e){var t=[],r=[],n={},s=this.types={},c=this.stringify=function(t,r,n,o){o=Object.assign({},e,o,{stringification:!0});var i=f(t,null,o);return a(i)?JSON.stringify(i[0],r,n):i.then((function(e){return JSON.stringify(e,r,n)}))};this.stringifySync=function(e,t,r,n){return c(e,t,r,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!0}))},this.stringifyAsync=function(e,t,r,n){return c(e,t,r,Object.assign({},{throwOnBadSyncType:!0},n,{sync:!1}))};var l=this.parse=function(t,r,n){return n=Object.assign({},e,n,{parse:!0}),p(JSON.parse(t,r),n)};this.parseSync=function(e,t,r){return l(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!0}))},this.parseAsync=function(e,t,r){return l(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!1}))},this.specialTypeNames=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.returnTypeNames=!0,this.encapsulate(e,t,r)},this.rootTypeName=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.iterateNone=!0,this.encapsulate(e,t,r)};var f=this.encapsulate=function(s,c,l){var f=(l=Object.assign({sync:!0},e,l)).sync,h={},p=[],_=[],m=[],A=!(l&&"cyclic"in l)||l.cyclic,E=l.encapsulateObserver,S=x("",s,A,c||{},m);function j(e){var t=Object.values(h);if(l.iterateNone)return t.length?t[0]:w.getJSONType(e);if(t.length){if(l.returnTypeNames)return[].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(new Set(t)));e&&y(e)&&!e.hasOwnProperty("$types")?e.$types=h:e={$:e,$types:{$:h}}}else b(e)&&e.hasOwnProperty("$types")&&(e={$:e,$types:!0});return!l.returnTypeNames&&e}return m.length?f&&l.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(function e(t,r){return Promise.all(r.map((function(e){return e[1].p}))).then((function(n){return Promise.all(n.map((function(n){var o=[],u=r.splice(0,1)[0],a=i(u,7),s=a[0],c=a[2],l=a[3],f=a[4],d=a[5],h=a[6],p=x(s,n,c,l,o,!0,h),y=v(p,O);return s&&y?p.p.then((function(r){return f[d]=r,e(t,o)})):(s?f[d]=p:t=y?p.p:p,e(t,o))})))})).then((function(){return t}))}(S,m)).then(j):!f&&l.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():l.stringification&&f?[j(S)]:f?j(S):Promise.resolve(j(S));function D(e,t,r){Object.assign(e,t);var n=d.map((function(t){var r=e[t];return delete e[t],r}));r(),d.forEach((function(t,r){e[t]=n[r]}))}function x(e,r,n,i,s,c,f){var d=void 0,b={},m=void 0===r?"undefined":o(r),A=E?function(t){var o=f||i.type||w.getJSONType(r);E(Object.assign(t||b,{keypath:e,value:r,cyclic:n,stateObj:i,promisesData:s,resolvingTypesonPromise:c,awaitingTypesonPromise:v(r,O)},void 0!==o?{type:o}:{}))}:null;if(m in{string:1,boolean:1,number:1,undefined:1})return void 0===r||"number"===m&&(isNaN(r)||r===-1/0||r===1/0)?(d=B(e,r,i,s,!1,c,A))!==r&&(b={replaced:d}):d=r,A&&A(),d;if(null===r)return A&&A(),r;if(n&&!i.iterateIn&&!i.iterateUnsetNumeric){var S=p.indexOf(r);if(!(S<0))return h[e]="#",A&&A({cyclicKeypath:_[S]}),"#"+_[S];!0===n&&(p.push(r),_.push(e))}var j=y(r),C=a(r),F=(j||C)&&(!t.length||i.replaced)||i.iterateIn?r:B(e,r,i,s,j||C,null,A),I=void 0;if(F!==r?(d=F,b={replaced:F}):C||"array"===i.iterateIn?(I=new Array(r.length),b={clone:I}):j||"object"===i.iterateIn?b={clone:I={}}:""===e&&v(r,O)?(s.push([e,r,n,i,void 0,void 0,i.type]),d=r):d=r,A&&A(),l.iterateNone)return I||d;if(!I)return d;if(i.iterateIn){var T=function(t){var o={ownKeys:r.hasOwnProperty(t)};D(i,o,(function(){var o=e+(e?".":"")+g(t),u=x(o,r[t],!!n,i,s,c);v(u,O)?s.push([o,u,!!n,i,I,t,i.type]):void 0!==u&&(I[t]=u)}))};for(var P in r)T(P);A&&A({endIterateIn:!0,end:!0})}else u(r).forEach((function(t){var o=e+(e?".":"")+g(t);D(i,{ownKeys:!0},(function(){var e=x(o,r[t],!!n,i,s,c);v(e,O)?s.push([o,e,!!n,i,I,t,i.type]):void 0!==e&&(I[t]=e)}))})),A&&A({endIterateOwn:!0,end:!0});if(i.iterateUnsetNumeric){for(var N=r.length,R=function(t){if(!(t in r)){var o=e+(e?".":"")+t;D(i,{ownKeys:!1},(function(){var e=x(o,void 0,!!n,i,s,c);v(e,O)?s.push([o,e,!!n,i,I,t,i.type]):void 0!==e&&(I[t]=e)}))}},k=0;k<N;k++)R(k);A&&A({endIterateUnsetNumeric:!0,end:!0})}return I}function B(e,o,i,u,a,s,c){for(var l=a?t:r,d=l.length;d--;){var p=l[d];if(p.test(o,i)){var v=p.type;if(n[v]){var y=h[e];h[e]=y?[v].concat(y):v}return Object.assign(i,{type:v,replaced:!0}),!f&&p.replaceAsync||p.replace?(c&&c({replacing:!0}),x(e,p[f||!p.replaceAsync?"replace":"replaceAsync"](o,i),A&&"readonly",i,u,s,v)):(c&&c({typeDetected:!0}),x(e,o,A&&"readonly",i,u,s,v))}}return o}};this.encapsulateSync=function(e,t,r){return f(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!0}))},this.encapsulateAsync=function(e,t,r){return f(e,t,Object.assign({},{throwOnBadSyncType:!0},r,{sync:!1}))};var p=this.revive=function(t,r){var o=(r=Object.assign({sync:!0},e,r)).sync,s=t&&t.$types,c=!0;if(!s)return t;if(!0===s)return t.$;s.$&&y(s.$)&&(t=t.$,s=s.$,c=!1);var l=[],f={},d=function e(t,r,o,d,h,p){if(!c||"$types"!==t){var b=s[t];if(a(r)||y(r)){var w=a(r)?new Array(r.length):{};for(u(r).forEach((function(n){var i=e(t+(t?".":"")+g(n),r[n],o||w,d,w,n);v(i,E)?w[n]=void 0:void 0!==i&&(w[n]=i)})),r=w;l.length;){var _=i(l[0],4),m=_[0],O=_[1],S=_[2],j=_[3],D=A(m,O);if(v(D,E))S[j]=void 0;else{if(void 0===D)break;S[j]=D}l.splice(0,1)}}if(!b)return r;if("#"===b){var x=A(o,r.substr(1));return void 0===x&&l.push([o,r.substr(1),h,p]),x}var B=d.sync;return[].concat(b).reduce((function(e,t){var r=n[t];if(!r)throw new Error("Unregistered type: "+t);return r[B&&r.revive?"revive":!B&&r.reviveAsync?"reviveAsync":"revive"](e,f)}),r)}}("",t,null,r);return h(d=v(d,E)?void 0:d)?o&&r.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():d:!o&&r.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():o?d:Promise.resolve(d)};this.reviveSync=function(e,t){return p(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!0}))},this.reviveAsync=function(e,t){return p(e,Object.assign({},{throwOnBadSyncType:!0},t,{sync:!1}))},this.register=function(e,o){return o=o||{},[].concat(e).forEach((function e(i){if(a(i))return i.map(e);i&&u(i).forEach((function(e){if("#"===e)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(w.JSON_TYPES.includes(e))throw new TypeError("Plain JSON object types are reserved as type names");var u=i[e],c=u.testPlainObjects?t:r,l=c.filter((function(t){return t.type===e}));if(l.length&&(c.splice(c.indexOf(l[0]),1),delete n[e],delete s[e]),u){if("function"==typeof u){var f=u;u={test:function(e){return e&&e.constructor===f},replace:function(e){return _({},e)},revive:function(e){return _(Object.create(f.prototype),e)}}}else a(u)&&(u={test:u[0],replace:u[1],revive:u[2]});var d={type:e,test:u.test.bind(u)};u.replace&&(d.replace=u.replace.bind(u)),u.replaceAsync&&(d.replaceAsync=u.replaceAsync.bind(u));var h="number"==typeof o.fallback?o.fallback:o.fallback?0:1/0;if(u.testPlainObjects?t.splice(h,0,d):r.splice(h,0,d),u.revive||u.reviveAsync){var p={};u.revive&&(p.revive=u.revive.bind(u)),u.reviveAsync&&(p.reviveAsync=u.reviveAsync.bind(u)),n[e]=p}s[e]=u}}))})),this}}function _(e,t){return u(t).map((function(r){e[r]=t[r]})),e}function g(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function m(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function A(e,t){if(""===t)return e;var r=t.indexOf(".");if(r>-1){var n=e[m(t.substr(0,r))];return void 0===n?void 0:A(n,t.substr(r+1))}return e[m(t)]}function E(){}function O(e){this.p=new Promise(e)}O.prototype.then=function(e,t){var r=this;return new O((function(n,o){r.p.then((function(t){n(e?e(t):t)}),(function(e){r.p.catch((function(e){return t?t(e):Promise.reject(e)})).then(n,o)}))}))},O.prototype.catch=function(e){return this.then(null,e)},O.resolve=function(e){return new O((function(t){t(e)}))},O.reject=function(e){return new O((function(t,r){r(e)}))},["all","race"].map((function(e){O[e]=function(t){return new O((function(r,n){Promise[e](t.map((function(e){return e.p}))).then(r,n)}))}})),w.Undefined=E,w.Promise=O,w.isThenable=h,w.toStringTag=p,w.hasConstructorOf=v,w.isObject=b,w.isPlainObject=y,w.isUserObject=function e(t){if(!t||"Object"!==p(t))return!1;var r=c(t);return!r||v(t,Object)||e(r)},w.escapeKeyPathComponent=g,w.unescapeKeyPathComponent=m,w.getByKeyPath=A,w.getJSONType=function(e){return null===e?"null":a(e)?"array":void 0===e?"undefined":o(e)},w.JSON_TYPES=["null","boolean","number","string","array","object"],t.exports=w},{}],48:[function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function o(e,t){return(t&&t.context?t.context:"Value")+" "+e+"."}function i(e){return a(Math.trunc(e))}function u(e){return e<0?-1:1}function a(e){return 0===e?0:e}function s(e,t){var r=!t.unsigned;var n=void 0;var s=void 0;64===e?(s=Math.pow(2,53)-1,n=r?1-Math.pow(2,53):0):r?(n=-Math.pow(2,e-1),s=Math.pow(2,e-1)-1):(n=0,s=Math.pow(2,e)-1);var c=Math.pow(2,e);var l=Math.pow(2,e-1);return function(e,t){void 0===t&&(t={});var f=+e;if(f=a(f),t.enforceRange){if(!Number.isFinite(f))throw new TypeError(o("is not a finite number",t));if((f=i(f))<n||f>s)throw new TypeError(o("is outside the accepted range of "+n+" to "+s+", inclusive",t));return f}return!Number.isNaN(f)&&t.clamp?f=function(e){return a(e>0&&e%1==.5&&0==(1&e)||e<0&&e%1==-.5&&1==(1&e)?Math.floor(e):Math.round(e))}(f=Math.min(Math.max(f,n),s)):Number.isFinite(f)&&0!==f?(f=i(f))>=n&&f<=s?f:(f=function(e,t){var r=e%t;return u(t)!==u(r)?r+t:r}(f,c),r&&f>=l?f-c:f):0}}function c(e,t){if("function"!=typeof e)throw new TypeError(o("is not a function",t));return e}r.any=function(e){return e},r.void=function(){},r.boolean=function(e){return!!e},r.byte=s(8,{unsigned:!1}),r.octet=s(8,{unsigned:!0}),r.short=s(16,{unsigned:!1}),r["unsigned short"]=s(16,{unsigned:!0}),r.long=s(32,{unsigned:!1}),r["unsigned long"]=s(32,{unsigned:!0}),r["long long"]=s(64,{unsigned:!1}),r["unsigned long long"]=s(64,{unsigned:!0}),r.double=function(e,t){var r=+e;if(!Number.isFinite(r))throw new TypeError(o("is not a finite floating-point value",t));return r},r["unrestricted double"]=function(e){return+e},r.float=function(e,t){var r=+e;if(!Number.isFinite(r))throw new TypeError(o("is not a finite floating-point value",t));if(Object.is(r,-0))return r;var n=Math.fround(r);if(!Number.isFinite(n))throw new TypeError(o("is outside the range of a single-precision floating-point value",t));return n},r["unrestricted float"]=function(e){var t=+e;return isNaN(t)||Object.is(t,-0)?t:Math.fround(t)},r.DOMString=function(e,t){if(void 0===t&&(t={}),t.treatNullAsEmptyString&&null===e)return"";if("symbol"===(void 0===e?"undefined":n(e)))throw new TypeError(o("is a symbol, which cannot be converted to a string",t));return String(e)},r.ByteString=function(e,t){var n=r.DOMString(e,t);var i=void 0;for(var u=0;void 0!==(i=n.codePointAt(u));++u)if(i>255)throw new TypeError(o("is not a valid ByteString",t));return n},r.USVString=function(e,t){var n=r.DOMString(e,t);var o=n.length;var i=[];for(var u=0;u<o;++u){var a=n.charCodeAt(u);if(a<55296||a>57343)i.push(String.fromCodePoint(a));else if(56320<=a&&a<=57343)i.push(String.fromCodePoint(65533));else if(u===o-1)i.push(String.fromCodePoint(65533));else{var s=n.charCodeAt(u+1);if(56320<=s&&s<=57343){var c=1023&a;var l=1023&s;i.push(String.fromCodePoint(65536+1024*c+l)),++u}else i.push(String.fromCodePoint(65533))}}return i.join("")},r.object=function(e,t){if("Object"!==function(e){if(null===e)return"Null";switch(void 0===e?"undefined":n(e)){case"undefined":return"Undefined";case"boolean":return"Boolean";case"number":return"Number";case"string":return"String";case"symbol":return"Symbol";case"object":case"function":default:return"Object"}}(e))throw new TypeError(o("is not an object",t));return e},[Error,ArrayBuffer,DataView,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Uint8ClampedArray,Float32Array,Float64Array].forEach((function(e){var t=e.name;var n=/^[AEIOU]/.test(t)?"an":"a";r[t]=function(r,i){if(!(r instanceof e))throw new TypeError(o("is not "+n+" "+t+" object",i));return r}})),r.ArrayBufferView=function(e,t){if(!ArrayBuffer.isView(e))throw new TypeError(o("is not a view on an ArrayBuffer object",t));return e},r.BufferSource=function(e,t){if(!(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))throw new TypeError(o("is not an ArrayBuffer object or a view on one",t));return e},r.DOMTimeStamp=r["unsigned long long"],r.Function=c,r.VoidFunction=c},{}]},{},[1])(1)}));var Ee=function(e){try{return Ae(e)}catch(e){throw new ae.DataCloneError}};var Oe=Ee;var Se=Object.defineProperty({default:Oe},"__esModule",{value:!0});var je=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var De=function(e){return e.source instanceof Rt.default?e.source:e.source.objectStore};var xe=function(e,t,r){var n,o,i,u;var a=void 0!==e?e.lower:void 0;var s=void 0!==e?e.upper:void 0;try{for(var c=je(t),l=c.next();!l.done;l=c.next()){var f=l.value;void 0!==f&&(void 0!==a&&1!==pe.default(a,f)||(a=f))}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}try{for(var d=je(r),h=d.next();!h.done;h=d.next()){var p=h.value;void 0!==p&&(void 0!==s&&-1!==pe.default(s,p)||(s=p))}}catch(e){i={error:e}}finally{try{h&&!h.done&&(u=d.return)&&u.call(d)}finally{if(i)throw i.error}}return void 0!==a&&void 0!==s?be.default.bound(a,s):void 0!==a?be.default.lowerBound(a):void 0!==s?be.default.upperBound(s):void 0};var Be=function(){function e(e,t,r,n,o){void 0===r&&(r="next"),void 0===o&&(o=!1),this._gotValue=!1,this._position=void 0,this._objectStorePosition=void 0,this._keyOnly=!1,this._key=void 0,this._primaryKey=void 0,this._range=t,this._source=e,this._direction=r,this._request=n,this._keyOnly=o}return Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{get:function(){return this._direction},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryKey",{get:function(){return this._primaryKey},set:function(e){},enumerable:!0,configurable:!0}),e.prototype._iterate=function(e,t){var r,n,o,i,u,a,s,c;var l=this.source instanceof Rt.default;var f=this.source instanceof Rt.default?this.source._rawObjectStore.records:this.source._rawIndex.records;var d;if("next"===this.direction){var h=xe(this._range,[e,this._position],[]);try{for(var p=je(f.values(h)),v=p.next();!v.done;v=p.next()){var y=v.value;var b=void 0!==e?pe.default(y.key,e):void 0;var w=void 0!==this._position?pe.default(y.key,this._position):void 0;if(void 0===e||-1!==b){if(void 0!==t){if(-1===b)continue;var _=pe.default(y.value,t);if(0===b&&-1===_)continue}if(void 0===this._position||!l||1===w){if(void 0!==this._position&&!l){if(-1===w)continue;if(0===w&&1!==pe.default(y.value,this._objectStorePosition))continue}if(void 0===this._range||this._range.includes(y.key)){d=y;break}}}}}catch(e){r={error:e}}finally{try{v&&!v.done&&(n=p.return)&&n.call(p)}finally{if(r)throw r.error}}}else if("nextunique"===this.direction){h=xe(this._range,[e,this._position],[]);try{for(var g=je(f.values(h)),m=g.next();!m.done;m=g.next())if(y=m.value,(void 0===e||-1!==pe.default(y.key,e))&&(void 0===this._position||1===pe.default(y.key,this._position))&&(void 0===this._range||this._range.includes(y.key))){d=y;break}}catch(e){o={error:e}}finally{try{m&&!m.done&&(i=g.return)&&i.call(g)}finally{if(o)throw o.error}}}else if("prev"===this.direction){h=xe(this._range,[],[e,this._position]);try{for(var A=je(f.values(h,"prev")),E=A.next();!E.done;E=A.next())if(y=E.value,b=void 0!==e?pe.default(y.key,e):void 0,w=void 0!==this._position?pe.default(y.key,this._position):void 0,void 0===e||1!==b){if(void 0!==t){if(1===b)continue;if(_=pe.default(y.value,t),0===b&&1===_)continue}if(void 0===this._position||!l||-1===w){if(void 0!==this._position&&!l){if(1===w)continue;if(0===w&&-1!==pe.default(y.value,this._objectStorePosition))continue}if(void 0===this._range||this._range.includes(y.key)){d=y;break}}}}catch(e){u={error:e}}finally{try{E&&!E.done&&(a=A.return)&&a.call(A)}finally{if(u)throw u.error}}}else if("prevunique"===this.direction){var O=void 0;h=xe(this._range,[],[e,this._position]);try{for(var S=je(f.values(h,"prev")),j=S.next();!j.done;j=S.next())if(y=j.value,(void 0===e||1!==pe.default(y.key,e))&&(void 0===this._position||-1===pe.default(y.key,this._position))&&(void 0===this._range||this._range.includes(y.key))){O=y;break}}catch(e){s={error:e}}finally{try{j&&!j.done&&(c=S.return)&&c.call(S)}finally{if(s)throw s.error}}O&&(d=f.get(O.key))}var D;if(d){if(this._position=d.key,l||(this._objectStorePosition=d.value),this._key=d.key,l)this._primaryKey=Se.default(d.key),this._keyOnly||"FDBCursorWithValue"!==this.constructor.name||(this.value=Se.default(d.value));else if(this._primaryKey=Se.default(d.value),!this._keyOnly&&"FDBCursorWithValue"===this.constructor.name){if(this.source instanceof Rt.default)throw new Error("This should never happen");var x=this.source.objectStore._rawObjectStore.getValue(d.value);this.value=Se.default(x)}this._gotValue=!0,D=this}else this._key=void 0,l||(this._objectStorePosition=void 0),this._keyOnly||"FDBCursorWithValue"!==this.constructor.name||(this.value=void 0),D=null;return D},e.prototype.update=function(e){if(void 0===e)throw new TypeError;var t=De(this);var r=this.source.hasOwnProperty("_rawIndex")?this.primaryKey:this._position;var n=t.transaction;if("active"!==n._state)throw new ae.TransactionInactiveError;if("readonly"===n.mode)throw new ae.ReadOnlyError;if(t._rawObjectStore.deleted)throw new ae.InvalidStateError;if(!(this.source instanceof Rt.default)&&this.source._rawIndex.deleted)throw new ae.InvalidStateError;if(!this._gotValue||!this.hasOwnProperty("value"))throw new ae.InvalidStateError;var o=Se.default(e);if(null!==t.keyPath){var i=void 0;try{i=me.default(t.keyPath,o)}catch(e){}if(0!==pe.default(i,r))throw new ae.DataError}var u={key:r,value:o};return n._execRequestAsync({operation:t._rawObjectStore.storeRecord.bind(t._rawObjectStore,u,!1,n._rollbackLog),source:this})},e.prototype.advance=function(e){var t=this;if(!Number.isInteger(e)||e<=0)throw new TypeError;var r=De(this);var n=r.transaction;if("active"!==n._state)throw new ae.TransactionInactiveError;if(r._rawObjectStore.deleted)throw new ae.InvalidStateError;if(!(this.source instanceof Rt.default)&&this.source._rawIndex.deleted)throw new ae.InvalidStateError;if(!this._gotValue)throw new ae.InvalidStateError;this._request&&(this._request.readyState="pending"),n._execRequestAsync({operation:function(){var r;for(var n=0;n<e&&(r=t._iterate());n++);return r},request:this._request,source:this.source}),this._gotValue=!1},e.prototype.continue=function(e){var t=De(this);var r=t.transaction;if("active"!==r._state)throw new ae.TransactionInactiveError;if(t._rawObjectStore.deleted)throw new ae.InvalidStateError;if(!(this.source instanceof Rt.default)&&this.source._rawIndex.deleted)throw new ae.InvalidStateError;if(!this._gotValue)throw new ae.InvalidStateError;if(void 0!==e){e=le.default(e);var n=pe.default(e,this._position);if(n<=0&&("next"===this.direction||"nextunique"===this.direction)||n>=0&&("prev"===this.direction||"prevunique"===this.direction))throw new ae.DataError}this._request&&(this._request.readyState="pending"),r._execRequestAsync({operation:this._iterate.bind(this,e),request:this._request,source:this.source}),this._gotValue=!1},e.prototype.continuePrimaryKey=function(e,t){var r=De(this);var n=r.transaction;if("active"!==n._state)throw new ae.TransactionInactiveError;if(r._rawObjectStore.deleted)throw new ae.InvalidStateError;if(!(this.source instanceof Rt.default)&&this.source._rawIndex.deleted)throw new ae.InvalidStateError;if(this.source instanceof Rt.default||"next"!==this.direction&&"prev"!==this.direction)throw new ae.InvalidAccessError;if(!this._gotValue)throw new ae.InvalidStateError;if(void 0===e||void 0===t)throw new ae.DataError;e=le.default(e);var o=pe.default(e,this._position);if(-1===o&&"next"===this.direction||1===o&&"prev"===this.direction)throw new ae.DataError;var i=pe.default(t,this._objectStorePosition);if(0===o&&(i<=0&&"next"===this.direction||i>=0&&"prev"===this.direction))throw new ae.DataError;this._request&&(this._request.readyState="pending"),n._execRequestAsync({operation:this._iterate.bind(this,e,t),request:this._request,source:this.source}),this._gotValue=!1},e.prototype.delete=function(){var e=De(this);var t=this.source.hasOwnProperty("_rawIndex")?this.primaryKey:this._position;var r=e.transaction;if("active"!==r._state)throw new ae.TransactionInactiveError;if("readonly"===r.mode)throw new ae.ReadOnlyError;if(e._rawObjectStore.deleted)throw new ae.InvalidStateError;if(!(this.source instanceof Rt.default)&&this.source._rawIndex.deleted)throw new ae.InvalidStateError;if(!this._gotValue||!this.hasOwnProperty("value"))throw new ae.InvalidStateError;return r._execRequestAsync({operation:e._rawObjectStore.deleteRecord.bind(e._rawObjectStore,t,r._rollbackLog),source:this})},e.prototype.toString=function(){return"[object IDBCursor]"},e}();var Ce=Be;var Fe=Object.defineProperty({default:Ce},"__esModule",{value:!0});var Ie=N&&N.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var Te=function(e){function t(t,r,n,o){var i=e.call(this,t,r,n,o)||this;return i.value=void 0,i}return Ie(t,e),t.prototype.toString=function(){return"[object IDBCursorWithValue]"},t}(Fe.default);var Pe=Te;var Ne=Object.defineProperty({default:Pe},"__esModule",{value:!0});var Re=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var ke=function(e,t){return e.immediatePropagationStopped||e.eventPhase===e.CAPTURING_PHASE&&!1===t.capture||e.eventPhase===e.BUBBLING_PHASE&&!0===t.capture};var Me=function(e,t){var r,n;e.currentTarget=t;try{for(var o=Re(t.listeners.slice()),i=o.next();!i.done;i=o.next()){var u=i.value;e.type!==u.type||ke(e,u)||u.callback.call(e.currentTarget,e)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}var a={abort:"onabort",blocked:"onblocked",complete:"oncomplete",error:"onerror",success:"onsuccess",upgradeneeded:"onupgradeneeded",versionchange:"onversionchange"}[e.type];if(void 0===a)throw new Error('Unknown event type: "'+e.type+'"');var s=e.currentTarget[a];s&&(u={callback:s,capture:!1,type:e.type},ke(e,u)||u.callback.call(e.currentTarget,e))};var Ue=function(){function e(){this.listeners=[]}return e.prototype.addEventListener=function(e,t,r){void 0===r&&(r=!1),this.listeners.push({callback:t,capture:r,type:e})},e.prototype.removeEventListener=function(e,t,r){void 0===r&&(r=!1);var n=this.listeners.findIndex((function(n){return n.type===e&&n.callback===t&&n.capture===r}));this.listeners.splice(n,1)},e.prototype.dispatchEvent=function(e){var t,r,n,o;if(e.dispatched||!e.initialized)throw new ae.InvalidStateError("The object is in an invalid state.");e.isTrusted=!1,e.dispatched=!0,e.target=this,e.eventPhase=e.CAPTURING_PHASE;try{for(var i=Re(e.eventPath),u=i.next();!u.done;u=i.next()){var a=u.value;e.propagationStopped||Me(e,a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}if(e.eventPhase=e.AT_TARGET,e.propagationStopped||Me(e,e.target),e.bubbles){e.eventPath.reverse(),e.eventPhase=e.BUBBLING_PHASE;try{for(var s=Re(e.eventPath),c=s.next();!c.done;c=s.next())a=c.value,e.propagationStopped||Me(e,a)}catch(e){n={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}}return e.dispatched=!1,e.eventPhase=e.NONE,e.currentTarget=null,!e.canceled},e}();var $e=Ue;var Ke=Object.defineProperty({default:$e},"__esModule",{value:!0});var Ve=N&&N.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var qe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._result=null,t._error=null,t.source=null,t.transaction=null,t.readyState="pending",t.onsuccess=null,t.onerror=null,t}return Ve(t,e),Object.defineProperty(t.prototype,"error",{get:function(){if("pending"===this.readyState)throw new ae.InvalidStateError;return this._error},set:function(e){this._error=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"result",{get:function(){if("pending"===this.readyState)throw new ae.InvalidStateError;return this._result},set:function(e){this._result=e},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"[object IDBRequest]"},t}(Ke.default);var Le=qe;var He=Object.defineProperty({default:Le},"__esModule",{value:!0});var We=function(e,t){var r="unsigned long"===t?4294967295:9007199254740991;if(isNaN(e)||e<0||e>r)throw new TypeError;if(e>=0)return Math.floor(e)};var Ge=We;var Je=Object.defineProperty({default:Ge},"__esModule",{value:!0});var ze=function(e){var t=e.slice();return Object.defineProperty(t,"contains",{value:function(e){return t.indexOf(e)>=0}}),Object.defineProperty(t,"item",{value:function(e){return t[e]}}),t};var Ye=ze;var Ze=Object.defineProperty({default:Ye},"__esModule",{value:!0});var Xe=function(e,t){if(void 0===t&&(t=!1),e instanceof be.default)return e;if(null==e){if(t)throw new ae.DataError;return new be.default(void 0,void 0,!1,!1)}var r=le.default(e);return be.default.only(r)};var Qe=Xe;var et=Object.defineProperty({default:Qe},"__esModule",{value:!0});var tt=function(e){if(e._rawIndex.deleted||e.objectStore._rawObjectStore.deleted)throw new ae.InvalidStateError;if("active"!==e.objectStore.transaction._state)throw new ae.TransactionInactiveError};var rt=function(){function e(e,t){this._rawIndex=t,this._name=t.name,this.objectStore=e,this.keyPath=t.keyPath,this.multiEntry=t.multiEntry,this.unique=t.unique}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){var t=this;var r=this.objectStore.transaction;if(!r.db._runningVersionchangeTransaction)throw new ae.InvalidStateError;if("active"!==r._state)throw new ae.TransactionInactiveError;if(this._rawIndex.deleted||this.objectStore._rawObjectStore.deleted)throw new ae.InvalidStateError;if((e=String(e))!==this._name){if(this.objectStore.indexNames.indexOf(e)>=0)throw new ae.ConstraintError;var n=this._name;var o=this.objectStore.indexNames.slice();this._name=e,this._rawIndex.name=e,this.objectStore._indexesCache.delete(n),this.objectStore._indexesCache.set(e,this),this.objectStore._rawObjectStore.rawIndexes.delete(n),this.objectStore._rawObjectStore.rawIndexes.set(e,this._rawIndex),this.objectStore.indexNames=Ze.default(Array.from(this.objectStore._rawObjectStore.rawIndexes.keys()).filter((function(e){var r=t.objectStore._rawObjectStore.rawIndexes.get(e);return r&&!r.deleted}))).sort(),r._rollbackLog.push((function(){t._name=n,t._rawIndex.name=n,t.objectStore._indexesCache.delete(e),t.objectStore._indexesCache.set(n,t),t.objectStore._rawObjectStore.rawIndexes.delete(e),t.objectStore._rawObjectStore.rawIndexes.set(n,t._rawIndex),t.objectStore.indexNames=Ze.default(o)}))}},enumerable:!0,configurable:!0}),e.prototype.openCursor=function(e,t){tt(this),null===e&&(e=void 0),void 0===e||e instanceof be.default||(e=be.default.only(le.default(e)));var r=new He.default;r.source=this,r.transaction=this.objectStore.transaction;var n=new Ne.default(this,e,t,r);return this.objectStore.transaction._execRequestAsync({operation:n._iterate.bind(n),request:r,source:this})},e.prototype.openKeyCursor=function(e,t){tt(this),null===e&&(e=void 0),void 0===e||e instanceof be.default||(e=be.default.only(le.default(e)));var r=new He.default;r.source=this,r.transaction=this.objectStore.transaction;var n=new Fe.default(this,e,t,r,!0);return this.objectStore.transaction._execRequestAsync({operation:n._iterate.bind(n),request:r,source:this})},e.prototype.get=function(e){return tt(this),e instanceof be.default||(e=le.default(e)),this.objectStore.transaction._execRequestAsync({operation:this._rawIndex.getValue.bind(this._rawIndex,e),source:this})},e.prototype.getAll=function(e,t){arguments.length>1&&void 0!==t&&(t=Je.default(t,"unsigned long")),tt(this);var r=et.default(e);return this.objectStore.transaction._execRequestAsync({operation:this._rawIndex.getAllValues.bind(this._rawIndex,r,t),source:this})},e.prototype.getKey=function(e){return tt(this),e instanceof be.default||(e=le.default(e)),this.objectStore.transaction._execRequestAsync({operation:this._rawIndex.getKey.bind(this._rawIndex,e),source:this})},e.prototype.getAllKeys=function(e,t){arguments.length>1&&void 0!==t&&(t=Je.default(t,"unsigned long")),tt(this);var r=et.default(e);return this.objectStore.transaction._execRequestAsync({operation:this._rawIndex.getAllKeys.bind(this._rawIndex,r,t),source:this})},e.prototype.count=function(e){var t=this;return tt(this),null===e&&(e=void 0),void 0===e||e instanceof be.default||(e=be.default.only(le.default(e))),this.objectStore.transaction._execRequestAsync({operation:function(){var r=0;var n=new Fe.default(t,e);for(;null!==n._iterate();)r+=1;return r},source:this})},e.prototype.toString=function(){return"[object IDBIndex]"},e}();var nt=rt;var ot=Object.defineProperty({default:nt},"__esModule",{value:!0});var it=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var ut=function(e,t){var r,n;if(Array.isArray(e))throw new Error("The key paths used in this section are always strings and never sequences, since it is not possible to create a object store which has a key generator and also has a key path that is a sequence.");var o=e.split(".");if(0===o.length)throw new Error("Assert: identifiers is not empty");o.pop();try{for(var i=it(o),u=i.next();!u.done;u=i.next()){var a=u.value;if("object"!=typeof t&&!Array.isArray(t))return!1;if(!t.hasOwnProperty(a))return!0;t=t[a]}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return"object"==typeof t||Array.isArray(t)};var at=ut;var st=Object.defineProperty({default:at},"__esModule",{value:!0});function ct(e,t){var r=0;var n=e.length;var o;for(;r<n;)o=r+n>>>1,pe.default(e[o].key,t)<0?r=o+1:n=o;return r}function lt(e,t){var r=ct(e,t);var n=e[r];return n&&0===pe.default(n.key,t)?r:-1}var ft=lt;function dt(e,t){return e[lt(e,t)]}var ht=dt;function pt(e,t){var r=void 0===t.lower?0:ct(e,t.lower);var n=void 0===t.upper?e.length-1:ct(e,t.upper);for(var o=r;o<=n;o++){var i=e[o];if(i&&t.includes(i.key))return o}return-1}var vt=pt;function yt(e,t){return e[pt(e,t)]}var bt=yt;function wt(e,t){var r=ct(e,t);var n=e[r];return n&&pe.default(n.key,t)>=0?r:-1}var _t=wt;var gt=Object.defineProperty({getIndexByKey:ft,getByKey:ht,getIndexByKeyRange:vt,getByKeyRange:bt,getIndexByKeyGTE:_t},"__esModule",{value:!0});var mt=function(){function e(){this.records=[]}return e.prototype.get=function(e){return e instanceof be.default?gt.getByKeyRange(this.records,e):gt.getByKey(this.records,e)},e.prototype.add=function(e){var t;if(0===this.records.length)t=0;else if(-1===(t=gt.getIndexByKeyGTE(this.records,e.key)))t=this.records.length;else for(;t<this.records.length&&0===pe.default(this.records[t].key,e.key)&&-1===pe.default(this.records[t].value,e.value);)t+=1;this.records.splice(t,0,e)},e.prototype.delete=function(e){var t=[];var r=e instanceof be.default;for(;;){var n=r?gt.getIndexByKeyRange(this.records,e):gt.getIndexByKey(this.records,e);if(-1===n)break;t.push(this.records[n]),this.records.splice(n,1)}return t},e.prototype.deleteByValue=function(e){var t=e instanceof be.default?e:be.default.only(e);var r=[];return this.records=this.records.filter((function(e){var n=t.includes(e.value);return n&&r.push(e),!n})),r},e.prototype.clear=function(){var e=this.records.slice();return this.records=[],e},e.prototype.values=function(e,t){var r;var n=this;return void 0===t&&(t="next"),(r={})[Symbol.iterator]=function(){var r;if("next"===t){if(r=0,void 0!==e&&void 0!==e.lower)for(;void 0!==n.records[r]&&1!==(o=pe.default(n.records[r].key,e.lower))&&(0!==o||e.lowerOpen);)r+=1}else if(r=n.records.length-1,void 0!==e&&void 0!==e.upper)for(;void 0!==n.records[r];){var o;if(-1===(o=pe.default(n.records[r].key,e.upper))||0===o&&!e.upperOpen)break;r-=1}return{next:function(){var o;var i;var u;return"next"===t?(i=n.records[r],o=r>=n.records.length,r+=1,o||void 0===e||void 0===e.upper||(o=1===(u=pe.default(i.key,e.upper))||0===u&&e.upperOpen)&&(i=void 0)):(i=n.records[r],o=r<0,r-=1,o||void 0===e||void 0===e.lower||(o=-1===(u=pe.default(i.key,e.lower))||0===u&&e.lowerOpen)&&(i=void 0)),{done:o,value:i}}}},r},e}();var At=mt;var Et=Object.defineProperty({default:At},"__esModule",{value:!0});var Ot=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var St=function(){function e(e,t,r,n,o){this.deleted=!1,this.initialized=!1,this.records=new Et.default,this.rawObjectStore=e,this.name=t,this.keyPath=r,this.multiEntry=n,this.unique=o}return e.prototype.getKey=function(e){var t=this.records.get(e);return void 0!==t?t.value:void 0},e.prototype.getAllKeys=function(e,t){var r,n;void 0!==t&&0!==t||(t=1/0);var o=[];try{for(var i=Ot(this.records.values(e)),u=i.next();!u.done;u=i.next()){var a=u.value;if(o.push(Se.default(a.value)),o.length>=t)break}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},e.prototype.getValue=function(e){var t=this.records.get(e);return void 0!==t?this.rawObjectStore.getValue(t.value):void 0},e.prototype.getAllValues=function(e,t){var r,n;void 0!==t&&0!==t||(t=1/0);var o=[];try{for(var i=Ot(this.records.values(e)),u=i.next();!u.done;u=i.next()){var a=u.value;if(o.push(this.rawObjectStore.getValue(a.value)),o.length>=t)break}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},e.prototype.storeRecord=function(e){var t,r,n,o,i,u;var a;try{a=me.default(this.keyPath,e.value)}catch(e){if("DataError"===e.name)return;throw e}if(this.multiEntry&&Array.isArray(a)){var s=[];try{for(var c=Ot(a),l=c.next();!l.done;l=c.next()){var f=l.value;if(s.indexOf(f)<0)try{s.push(le.default(f))}catch(e){}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}}a=s}else try{le.default(a)}catch(e){return}if(this.multiEntry&&Array.isArray(a)){if(this.unique)try{for(var d=Ot(a),h=d.next();!h.done;h=d.next()){var p=h.value;if(this.records.get(p))throw new ae.ConstraintError}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}}else if(this.unique&&this.records.get(a))throw new ae.ConstraintError;if(this.multiEntry&&Array.isArray(a))try{for(var v=Ot(a),y=v.next();!y.done;y=v.next())p=y.value,this.records.add({key:p,value:e.key})}catch(e){i={error:e}}finally{try{y&&!y.done&&(u=v.return)&&u.call(v)}finally{if(i)throw i.error}}else this.records.add({key:a,value:e.key})},e.prototype.initialize=function(e){var t=this;if(this.initialized)throw new Error("Index already initialized");e._execRequestAsync({operation:function(){var r,n;try{try{for(var o=Ot(t.rawObjectStore.records.values()),i=o.next();!i.done;i=o.next()){var u=i.value;t.storeRecord(u)}}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}t.initialized=!0}catch(t){e._abort(t.name)}},source:null})},e}();var jt=St;var Dt=Object.defineProperty({default:jt},"__esModule",{value:!0});var xt=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var Bt=function(e,t){var r,n,o,i;if(null==e||"string"==typeof e||!e.toString||"array"!==t&&Array.isArray(e)||(e=e.toString()),"string"==typeof e){if(""===e&&"string"!==t)return;try{if(e.length>=1&&/^(?:[\$A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B2\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC])(?:[\$0-9A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u08A0-\u08B2\u08E4-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58\u0C59\u0C60-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D60-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1CD0-\u1CD2\u1CD4-\u1CF6\u1CF8\u1CF9\u1D00-\u1DF5\u1DFC-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u200C\u200D\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA69D\uA69F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uAB65\uABC0-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2D\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC])*$/.test(e))return}catch(e){throw new SyntaxError(e.message)}if(e.indexOf(" ")>=0)throw new SyntaxError("The keypath argument contains an invalid key path (no spaces allowed).")}if(Array.isArray(e)&&e.length>0){if(t)throw new SyntaxError("The keypath argument contains an invalid key path (nested arrays).");try{for(var u=xt(e),a=u.next();!a.done;a=u.next()){var s=a.value;Bt(s,"array")}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=u.return)&&n.call(u)}finally{if(r)throw r.error}}}else{if(!("string"==typeof e&&e.indexOf(".")>=0))throw new SyntaxError;e=e.split(".");try{for(var c=xt(e),l=c.next();!l.done;l=c.next())s=l.value,Bt(s,"string")}catch(e){o={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}}};var Ct=Bt;var Ft=Object.defineProperty({default:Ct},"__esModule",{value:!0});var It=function(e){if(e._rawObjectStore.deleted)throw new ae.InvalidStateError;if("active"!==e.transaction._state)throw new ae.TransactionInactiveError};var Tt=function(e,t,r){if(It(e),"readonly"===e.transaction.mode)throw new ae.ReadOnlyError;if(null!==e.keyPath&&void 0!==r)throw new ae.DataError;var n=Se.default(t);if(null!==e.keyPath){var o=me.default(e.keyPath,n);if(void 0!==o)le.default(o);else{if(!e._rawObjectStore.keyGenerator)throw new ae.DataError;if(!st.default(e.keyPath,n))throw new ae.DataError}}if(null===e.keyPath&&null===e._rawObjectStore.keyGenerator&&void 0===r)throw new ae.DataError;return void 0!==r&&(r=le.default(r)),{key:r,value:n}};var Pt=function(){function e(e,t){this._indexesCache=new Map,this._rawObjectStore=t,this._name=t.name,this.keyPath=t.keyPath,this.autoIncrement=t.autoIncrement,this.transaction=e,this.indexNames=Ze.default(Array.from(t.rawIndexes.keys())).sort()}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){var t=this;var r=this.transaction;if(!r.db._runningVersionchangeTransaction)throw new ae.InvalidStateError;if(It(this),(e=String(e))!==this._name){if(this._rawObjectStore.rawDatabase.rawObjectStores.has(e))throw new ae.ConstraintError;var n=this._name;var o=r.db.objectStoreNames.slice();this._name=e,this._rawObjectStore.name=e,this.transaction._objectStoresCache.delete(n),this.transaction._objectStoresCache.set(e,this),this._rawObjectStore.rawDatabase.rawObjectStores.delete(n),this._rawObjectStore.rawDatabase.rawObjectStores.set(e,this._rawObjectStore),r.db.objectStoreNames=Ze.default(Array.from(this._rawObjectStore.rawDatabase.rawObjectStores.keys()).filter((function(e){var r=t._rawObjectStore.rawDatabase.rawObjectStores.get(e);return r&&!r.deleted}))).sort();var i=new Set(r._scope);var u=r.objectStoreNames.slice();this.transaction._scope.delete(n),r._scope.add(e),r.objectStoreNames=Ze.default(Array.from(r._scope).sort()),r._rollbackLog.push((function(){t._name=n,t._rawObjectStore.name=n,t.transaction._objectStoresCache.delete(e),t.transaction._objectStoresCache.set(n,t),t._rawObjectStore.rawDatabase.rawObjectStores.delete(e),t._rawObjectStore.rawDatabase.rawObjectStores.set(n,t._rawObjectStore),r.db.objectStoreNames=Ze.default(o),r._scope=i,r.objectStoreNames=Ze.default(u)}))}},enumerable:!0,configurable:!0}),e.prototype.put=function(e,t){if(0===arguments.length)throw new TypeError;var r=Tt(this,e,t);return this.transaction._execRequestAsync({operation:this._rawObjectStore.storeRecord.bind(this._rawObjectStore,r,!1,this.transaction._rollbackLog),source:this})},e.prototype.add=function(e,t){if(0===arguments.length)throw new TypeError;var r=Tt(this,e,t);return this.transaction._execRequestAsync({operation:this._rawObjectStore.storeRecord.bind(this._rawObjectStore,r,!0,this.transaction._rollbackLog),source:this})},e.prototype.delete=function(e){if(0===arguments.length)throw new TypeError;if(It(this),"readonly"===this.transaction.mode)throw new ae.ReadOnlyError;return e instanceof be.default||(e=le.default(e)),this.transaction._execRequestAsync({operation:this._rawObjectStore.deleteRecord.bind(this._rawObjectStore,e,this.transaction._rollbackLog),source:this})},e.prototype.get=function(e){if(0===arguments.length)throw new TypeError;return It(this),e instanceof be.default||(e=le.default(e)),this.transaction._execRequestAsync({operation:this._rawObjectStore.getValue.bind(this._rawObjectStore,e),source:this})},e.prototype.getAll=function(e,t){arguments.length>1&&void 0!==t&&(t=Je.default(t,"unsigned long")),It(this);var r=et.default(e);return this.transaction._execRequestAsync({operation:this._rawObjectStore.getAllValues.bind(this._rawObjectStore,r,t),source:this})},e.prototype.getKey=function(e){if(0===arguments.length)throw new TypeError;return It(this),e instanceof be.default||(e=le.default(e)),this.transaction._execRequestAsync({operation:this._rawObjectStore.getKey.bind(this._rawObjectStore,e),source:this})},e.prototype.getAllKeys=function(e,t){arguments.length>1&&void 0!==t&&(t=Je.default(t,"unsigned long")),It(this);var r=et.default(e);return this.transaction._execRequestAsync({operation:this._rawObjectStore.getAllKeys.bind(this._rawObjectStore,r,t),source:this})},e.prototype.clear=function(){if(It(this),"readonly"===this.transaction.mode)throw new ae.ReadOnlyError;return this.transaction._execRequestAsync({operation:this._rawObjectStore.clear.bind(this._rawObjectStore,this.transaction._rollbackLog),source:this})},e.prototype.openCursor=function(e,t){It(this),null===e&&(e=void 0),void 0===e||e instanceof be.default||(e=be.default.only(le.default(e)));var r=new He.default;r.source=this,r.transaction=this.transaction;var n=new Ne.default(this,e,t,r);return this.transaction._execRequestAsync({operation:n._iterate.bind(n),request:r,source:this})},e.prototype.openKeyCursor=function(e,t){It(this),null===e&&(e=void 0),void 0===e||e instanceof be.default||(e=be.default.only(le.default(e)));var r=new He.default;r.source=this,r.transaction=this.transaction;var n=new Fe.default(this,e,t,r,!0);return this.transaction._execRequestAsync({operation:n._iterate.bind(n),request:r,source:this})},e.prototype.createIndex=function(e,t,r){var n=this;if(void 0===r&&(r={}),arguments.length<2)throw new TypeError;var o=void 0!==r.multiEntry&&r.multiEntry;var i=void 0!==r.unique&&r.unique;if("versionchange"!==this.transaction.mode)throw new ae.InvalidStateError;if(It(this),this.indexNames.indexOf(e)>=0)throw new ae.ConstraintError;if(Ft.default(t),Array.isArray(t)&&o)throw new ae.InvalidAccessError;var u=this.indexNames.slice();this.transaction._rollbackLog.push((function(){var t=n._rawObjectStore.rawIndexes.get(e);t&&(t.deleted=!0),n.indexNames=Ze.default(u),n._rawObjectStore.rawIndexes.delete(e)}));var a=new Dt.default(this._rawObjectStore,e,t,o,i);return this.indexNames.push(e),this.indexNames.sort(),this._rawObjectStore.rawIndexes.set(e,a),a.initialize(this.transaction),new ot.default(this,a)},e.prototype.index=function(e){if(0===arguments.length)throw new TypeError;if(this._rawObjectStore.deleted||"finished"===this.transaction._state)throw new ae.InvalidStateError;var t=this._indexesCache.get(e);if(void 0!==t)return t;var r=this._rawObjectStore.rawIndexes.get(e);if(this.indexNames.indexOf(e)<0||void 0===r)throw new ae.NotFoundError;var n=new ot.default(this,r);return this._indexesCache.set(e,n),n},e.prototype.deleteIndex=function(e){var t=this;if(0===arguments.length)throw new TypeError;if("versionchange"!==this.transaction.mode)throw new ae.InvalidStateError;It(this);var r=this._rawObjectStore.rawIndexes.get(e);if(void 0===r)throw new ae.NotFoundError;this.transaction._rollbackLog.push((function(){r.deleted=!1,t._rawObjectStore.rawIndexes.set(e,r),t.indexNames.push(e),t.indexNames.sort()})),this.indexNames=Ze.default(this.indexNames.filter((function(t){return t!==e}))),r.deleted=!0,this.transaction._execRequestAsync({operation:function(){var n=t._rawObjectStore.rawIndexes.get(e);r===n&&t._rawObjectStore.rawIndexes.delete(e)},source:this})},e.prototype.count=function(e){var t=this;return It(this),null===e&&(e=void 0),void 0===e||e instanceof be.default||(e=be.default.only(le.default(e))),this.transaction._execRequestAsync({operation:function(){var r=0;var n=new Fe.default(t,e);for(;null!==n._iterate();)r+=1;return r},source:this})},e.prototype.toString=function(){return"[object IDBObjectStore]"},e}();var Nt=Pt;var Rt=Object.defineProperty({default:Nt},"__esModule",{value:!0});var kt=function(){function e(e,t){void 0===t&&(t={}),this.eventPath=[],this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.canceled=!1,this.initialized=!0,this.dispatched=!1,this.target=null,this.currentTarget=null,this.eventPhase=0,this.defaultPrevented=!1,this.isTrusted=!1,this.timeStamp=Date.now(),this.type=e,this.bubbles=void 0!==t.bubbles&&t.bubbles,this.cancelable=void 0!==t.cancelable&&t.cancelable}return e.prototype.preventDefault=function(){this.cancelable&&(this.canceled=!0)},e.prototype.stopPropagation=function(){this.propagationStopped=!0},e.prototype.stopImmediatePropagation=function(){this.propagationStopped=!0,this.immediatePropagationStopped=!0},e}();var Mt=kt;var Ut=Object.defineProperty({default:Mt},"__esModule",{value:!0});var $t=N&&N.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var Kt=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var Vt=function(e){function t(t,r,n){var o=e.call(this)||this;return o._state="active",o._started=!1,o._rollbackLog=[],o._objectStoresCache=new Map,o.error=null,o.onabort=null,o.oncomplete=null,o.onerror=null,o._requests=[],o._scope=new Set(t),o.mode=r,o.db=n,o.objectStoreNames=Ze.default(Array.from(o._scope).sort()),o}return $t(t,e),t.prototype._abort=function(e){var t,r,n,o;var i=this;try{for(var u=Kt(this._rollbackLog.reverse()),a=u.next();!a.done;a=u.next())(0,a.value)()}catch(e){t={error:e}}finally{try{a&&!a.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}if(null!==e){var s=new Error;s.name=e,this.error=s}try{for(var c=Kt(this._requests),l=c.next();!l.done;l=c.next()){var f=l.value.request;if("done"!==f.readyState&&(f.readyState="done",f.source)){f.result=void 0,f.error=new ae.AbortError;var d=new Ut.default("error",{bubbles:!0,cancelable:!0});d.eventPath=[this.db,this],f.dispatchEvent(d)}}}catch(e){n={error:e}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}setImmediate((function(){var e=new Ut.default("abort",{bubbles:!0,cancelable:!1});e.eventPath=[i.db],i.dispatchEvent(e)})),this._state="finished"},t.prototype.abort=function(){if("committing"===this._state||"finished"===this._state)throw new ae.InvalidStateError;this._state="active",this._abort(null)},t.prototype.objectStore=function(e){if("active"!==this._state)throw new ae.InvalidStateError;var t=this._objectStoresCache.get(e);if(void 0!==t)return t;var r=this.db._rawDatabase.rawObjectStores.get(e);if(!this._scope.has(e)||void 0===r)throw new ae.NotFoundError;var n=new Rt.default(this,r);return this._objectStoresCache.set(e,n),n},t.prototype._execRequestAsync=function(e){var t=e.source;var r=e.operation;var n=e.hasOwnProperty("request")?e.request:null;if("active"!==this._state)throw new ae.TransactionInactiveError;return n||(t?((n=new He.default).source=t,n.transaction=t.transaction):n=new He.default),this._requests.push({operation:r,request:n}),n},t.prototype._start=function(){var e;var t;for(this._started=!0;this._requests.length>0;){var r=this._requests.shift();if(r&&"done"!==r.request.readyState){t=r.request,e=r.operation;break}}if(t&&e){if(t.source){var n=void 0;var o;try{var i=e();t.readyState="done",t.result=i,t.error=void 0,"inactive"===this._state&&(this._state="active"),o=new Ut.default("success",{bubbles:!1,cancelable:!1})}catch(e){t.readyState="done",t.result=void 0,t.error=e,"inactive"===this._state&&(this._state="active"),o=new Ut.default("error",{bubbles:!0,cancelable:!0}),n=this._abort.bind(this,e.name)}try{o.eventPath=[this.db,this],t.dispatchEvent(o)}catch(e){throw"committing"!==this._state&&this._abort("AbortError"),e}o.canceled||n&&n()}else e();setImmediate(this._start.bind(this))}else if("finished"!==this._state&&(this._state="finished",!this.error)){var u=new Ut.default("complete");this.dispatchEvent(u)}},t.prototype.commit=function(){if("active"!==this._state)throw new ae.InvalidStateError;this._state="committing"},t.prototype.toString=function(){return"[object IDBRequest]"},t}(Ke.default);var qt=Vt;var Lt=Object.defineProperty({default:qt},"__esModule",{value:!0});var Ht=9007199254740992;var Wt=function(){function e(){this.num=0}return e.prototype.next=function(){if(this.num>=Ht)throw new ae.ConstraintError;return this.num+=1,this.num},e.prototype.setIfLarger=function(e){var t=Math.floor(Math.min(e,Ht))-1;t>=this.num&&(this.num=t+1)},e}();var Gt=Wt;var Jt=Object.defineProperty({default:Gt},"__esModule",{value:!0});var zt=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var Yt=function(){function e(e,t,r,n){this.deleted=!1,this.records=new Et.default,this.rawIndexes=new Map,this.rawDatabase=e,this.keyGenerator=!0===n?new Jt.default:null,this.deleted=!1,this.name=t,this.keyPath=r,this.autoIncrement=n}return e.prototype.getKey=function(e){var t=this.records.get(e);return void 0!==t?Se.default(t.key):void 0},e.prototype.getAllKeys=function(e,t){var r,n;void 0!==t&&0!==t||(t=1/0);var o=[];try{for(var i=zt(this.records.values(e)),u=i.next();!u.done;u=i.next()){var a=u.value;if(o.push(Se.default(a.key)),o.length>=t)break}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},e.prototype.getValue=function(e){var t=this.records.get(e);return void 0!==t?Se.default(t.value):void 0},e.prototype.getAllValues=function(e,t){var r,n;void 0!==t&&0!==t||(t=1/0);var o=[];try{for(var i=zt(this.records.values(e)),u=i.next();!u.done;u=i.next()){var a=u.value;if(o.push(Se.default(a.value)),o.length>=t)break}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return o},e.prototype.storeRecord=function(e,t,r){var n,o;var i=this;if(null!==this.keyPath){var u=me.default(this.keyPath,e.value);void 0!==u&&(e.key=u)}if(null!==this.keyGenerator&&void 0===e.key){if(r){var a=this.keyGenerator.num;r.push((function(){i.keyGenerator&&(i.keyGenerator.num=a)}))}if(e.key=this.keyGenerator.next(),null!==this.keyPath){if(Array.isArray(this.keyPath))throw new Error("Cannot have an array key path in an object store with a key generator");var s=this.keyPath;var c=e.value;var l=void 0;var f=0;for(;f>=0;){if("object"!=typeof c)throw new ae.DataError;(f=s.indexOf("."))>=0&&(l=s.slice(0,f),s=s.slice(f+1),c.hasOwnProperty(l)||(c[l]={}),c=c[l])}c[l=s]=e.key}}else null!==this.keyGenerator&&"number"==typeof e.key&&this.keyGenerator.setIfLarger(e.key);if(this.records.get(e.key)){if(t)throw new ae.ConstraintError;this.deleteRecord(e.key,r)}this.records.add(e),r&&r.push((function(){i.deleteRecord(e.key)}));try{for(var d=zt(this.rawIndexes.values()),h=d.next();!h.done;h=d.next()){var p=h.value;p.initialized&&p.storeRecord(e)}}catch(e){n={error:e}}finally{try{h&&!h.done&&(o=d.return)&&o.call(d)}finally{if(n)throw n.error}}return e.key},e.prototype.deleteRecord=function(e,t){var r,n,o,i;var u=this;var a=this.records.delete(e);if(t){var s=function(e){t.push((function(){u.storeRecord(e,!0)}))};try{for(var c=zt(a),l=c.next();!l.done;l=c.next())s(l.value)}catch(e){r={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}}try{for(var f=zt(this.rawIndexes.values()),d=f.next();!d.done;d=f.next())d.value.records.deleteByValue(e)}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}},e.prototype.clear=function(e){var t,r,n,o;var i=this;var u=this.records.clear();if(e){var a=function(t){e.push((function(){i.storeRecord(t,!0)}))};try{for(var s=zt(u),c=s.next();!c.done;c=s.next())a(c.value)}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}}try{for(var l=zt(this.rawIndexes.values()),f=l.next();!f.done;f=l.next())f.value.records.clear()}catch(e){n={error:e}}finally{try{f&&!f.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}},e}();var Zt=Yt;var Xt=Object.defineProperty({default:Zt},"__esModule",{value:!0});var Qt=N&&N.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var er=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var tr=function(e){if(!e._runningVersionchangeTransaction)throw new ae.InvalidStateError;var t=e._rawDatabase.transactions.filter((function(e){return"versionchange"===e.mode}));var r=t[t.length-1];if(!r||"finished"===r._state)throw new ae.InvalidStateError;if("active"!==r._state)throw new ae.TransactionInactiveError;return r};var rr=function(e){e._closePending=!0,e._rawDatabase.transactions.every((function(e){return"finished"===e._state}))?(e._closed=!0,e._rawDatabase.connections=e._rawDatabase.connections.filter((function(t){return e!==t}))):setImmediate((function(){rr(e)}))};var nr=function(e){function t(t){var r=e.call(this)||this;return r._closePending=!1,r._closed=!1,r._runningVersionchangeTransaction=!1,r._rawDatabase=t,r._rawDatabase.connections.push(r),r.name=t.name,r.version=t.version,r.objectStoreNames=Ze.default(Array.from(t.rawObjectStores.keys())).sort(),r}return Qt(t,e),t.prototype.createObjectStore=function(e,t){var r=this;if(void 0===t&&(t={}),void 0===e)throw new TypeError;var n=tr(this);var o=null!==t&&void 0!==t.keyPath?t.keyPath:null;var i=null!==t&&void 0!==t.autoIncrement&&t.autoIncrement;if(null!==o&&Ft.default(o),this._rawDatabase.rawObjectStores.has(e))throw new ae.ConstraintError;if(i&&(""===o||Array.isArray(o)))throw new ae.InvalidAccessError;var u=this.objectStoreNames.slice();n._rollbackLog.push((function(){var t=r._rawDatabase.rawObjectStores.get(e);t&&(t.deleted=!0),r.objectStoreNames=Ze.default(u),n._scope.delete(e),r._rawDatabase.rawObjectStores.delete(e)}));var a=new Xt.default(this._rawDatabase,e,o,i);return this.objectStoreNames.push(e),this.objectStoreNames.sort(),n._scope.add(e),this._rawDatabase.rawObjectStores.set(e,a),n.objectStoreNames=Ze.default(this.objectStoreNames.slice()),n.objectStore(e)},t.prototype.deleteObjectStore=function(e){var t=this;if(void 0===e)throw new TypeError;var r=tr(this);var n=this._rawDatabase.rawObjectStores.get(e);if(void 0===n)throw new ae.NotFoundError;this.objectStoreNames=Ze.default(this.objectStoreNames.filter((function(t){return t!==e}))),r.objectStoreNames=Ze.default(this.objectStoreNames.slice()),r._rollbackLog.push((function(){n.deleted=!1,t._rawDatabase.rawObjectStores.set(e,n),t.objectStoreNames.push(e),t.objectStoreNames.sort()})),n.deleted=!0,this._rawDatabase.rawObjectStores.delete(e),r._objectStoresCache.delete(e)},t.prototype.transaction=function(e,t){var r,n;var o=this;if("readonly"!==(t=void 0!==t?t:"readonly")&&"readwrite"!==t&&"versionchange"!==t)throw new TypeError("Invalid mode: "+t);if(this._rawDatabase.transactions.some((function(e){return"active"===e._state&&"versionchange"===e.mode&&e.db===o})))throw new ae.InvalidStateError;if(this._closePending)throw new ae.InvalidStateError;if(Array.isArray(e)||(e=[e]),0===e.length&&"versionchange"!==t)throw new ae.InvalidAccessError;try{for(var i=er(e),u=i.next();!u.done;u=i.next()){var a=u.value;if(this.objectStoreNames.indexOf(a)<0)throw new ae.NotFoundError("No objectStore named "+a+" in this database")}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}var s=new Lt.default(e,t,this);return this._rawDatabase.transactions.push(s),this._rawDatabase.processTransactions(),s},t.prototype.close=function(){rr(this)},t.prototype.toString=function(){return"[object IDBDatabase]"},t}(Ke.default);var or=nr;var ir=Object.defineProperty({default:or},"__esModule",{value:!0});var ur=N&&N.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var ar=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onupgradeneeded=null,t.onblocked=null,t}return ur(t,e),t.prototype.toString=function(){return"[object IDBOpenDBRequest]"},t}(He.default);var sr=ar;var cr=Object.defineProperty({default:sr},"__esModule",{value:!0});var lr=N&&N.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var fr=function(e){function t(t,r){void 0===r&&(r={});var n=e.call(this,t)||this;return n.newVersion=void 0!==r.newVersion?r.newVersion:null,n.oldVersion=void 0!==r.oldVersion?r.oldVersion:0,n}return lr(t,e),t.prototype.toString=function(){return"[object IDBVersionChangeEvent]"},t}(Ut.default);var dr=fr;var hr=Object.defineProperty({default:dr},"__esModule",{value:!0});var pr=function(){function e(e,t){this.deletePending=!1,this.transactions=[],this.rawObjectStores=new Map,this.connections=[],this.name=e,this.version=t,this.processTransactions=this.processTransactions.bind(this)}return e.prototype.processTransactions=function(){var e=this;setImmediate((function(){if(!e.transactions.some((function(e){return e._started&&"finished"!==e._state}))){var t=e.transactions.find((function(e){return!e._started&&"finished"!==e._state}));t&&(t.addEventListener("complete",e.processTransactions),t.addEventListener("abort",e.processTransactions),t._start())}}))},e}();var vr=pr;var yr=Object.defineProperty({default:vr},"__esModule",{value:!0});var br=N&&N.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};var wr=N&&N.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),u=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)u.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return u};var _r=function(e,t,r,n){r.some((function(e){return!e._closed&&!e._closePending}))?setImmediate((function(){return _r(e,t,r,n)})):(e.delete(t),n(null))};var gr=function(e,t,r,n){var o,i;try{var u=e.get(t);if(void 0===u)return void n(null);u.deletePending=!0;var a=u.connections.filter((function(e){return!e._closed&&!e._closePending}));try{for(var s=br(a),c=s.next();!c.done;c=s.next()){var l=c.value;if(!l._closePending){var f=new hr.default("versionchange",{newVersion:null,oldVersion:u.version});l.dispatchEvent(f)}}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}var d=a.some((function(e){return!e._closed&&!e._closePending}));if(r&&d){var h=new hr.default("blocked",{newVersion:null,oldVersion:u.version});r.dispatchEvent(h)}_r(e,t,a,n)}catch(e){n(e)}};var mr=function(e,t,r,n){var o,i;e._runningVersionchangeTransaction=!0;var u=e.version;var a=e._rawDatabase.connections.filter((function(t){return e!==t}));try{for(var s=br(a),c=s.next();!c.done;c=s.next()){var l=c.value;if(!l._closed&&!l._closePending){var f=new hr.default("versionchange",{newVersion:t,oldVersion:u});l.dispatchEvent(f)}}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}if(a.some((function(e){return!e._closed&&!e._closePending}))){var d=new hr.default("blocked",{newVersion:t,oldVersion:u});r.dispatchEvent(d)}var h=function(){if(a.some((function(e){return!e._closed&&!e._closePending})))setImmediate(h);else{e._rawDatabase.version=t,e.version=t;var o=e.transaction(e.objectStoreNames,"versionchange");r.result=e,r.readyState="done",r.transaction=o,o._rollbackLog.push((function(){e._rawDatabase.version=u,e.version=u}));var i=new hr.default("upgradeneeded",{newVersion:t,oldVersion:u});r.dispatchEvent(i),o.addEventListener("error",(function(){e._runningVersionchangeTransaction=!1})),o.addEventListener("abort",(function(){e._runningVersionchangeTransaction=!1,r.transaction=null,setImmediate((function(){n(new ae.AbortError)}))})),o.addEventListener("complete",(function(){e._runningVersionchangeTransaction=!1,r.transaction=null,setImmediate((function(){e._closePending?n(new ae.AbortError):n(null)}))}))}};h()};var Ar=function(e,t,r,n,o){var i=e.get(t);if(void 0===i&&(i=new yr.default(t,0),e.set(t,i)),void 0===r&&(r=0!==i.version?i.version:1),i.version>r)return o(new ae.VersionError);var u=new ir.default(i);i.version<r?mr(u,r,n,(function(e){if(e)return o(e);o(null,u)})):o(null,u)};var Er=function(){function e(){this.cmp=pe.default,this._databases=new Map}return e.prototype.deleteDatabase=function(e){var t=this;var r=new cr.default;return r.source=null,setImmediate((function(){var n=t._databases.get(e);var o=void 0!==n?n.version:0;gr(t._databases,e,r,(function(e){if(e){r.error=new Error,r.error.name=e.name,r.readyState="done";var t=new Ut.default("error",{bubbles:!0,cancelable:!0});return t.eventPath=[],void r.dispatchEvent(t)}r.result=void 0,r.readyState="done";var n=new hr.default("success",{newVersion:null,oldVersion:o});r.dispatchEvent(n)}))})),r},e.prototype.open=function(e,t){var r=this;if(arguments.length>1&&void 0!==t&&(t=Je.default(t,"MAX_SAFE_INTEGER")),0===t)throw new TypeError;var n=new cr.default;return n.source=null,setImmediate((function(){Ar(r._databases,e,t,n,(function(e,t){if(e){n.result=void 0,n.readyState="done",n.error=new Error,n.error.name=e.name;var r=new Ut.default("error",{bubbles:!0,cancelable:!0});return r.eventPath=[],void n.dispatchEvent(r)}n.result=t,n.readyState="done";var o=new Ut.default("success");o.eventPath=[],n.dispatchEvent(o)}))})),n},e.prototype.databases=function(){var e=this;return new Promise((function(t){var r,n;var o=[];try{for(var i=br(e._databases),u=i.next();!u.done;u=i.next()){var a=wr(u.value,2),s=a[0],c=a[1];o.push({name:s,version:c.version})}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}t(o)}))},e.prototype.toString=function(){return"[object IDBFactory]"},e}();var Or=Er;var Sr=Object.defineProperty({default:Or},"__esModule",{value:!0});var jr=new Sr.default;var Dr=jr;var xr=Object.defineProperty({default:Dr},"__esModule",{value:!0});var Br=xr.default;class Cr{constructor(e="keyval-store",t="keyval"){this.storeName=t,this._dbp=new Promise(((r,n)=>{const o=("undefined"!=typeof window&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB)||Br).open(e,1);o.onerror=()=>n(o.error),o.onsuccess=()=>r(o.result),o.onupgradeneeded=()=>{o.result.createObjectStore(t)}}))}withIDBStore(e,t){return this._dbp.then((r=>new Promise(((n,o)=>{const i=r.transaction(this.storeName,e);i.oncomplete=()=>n(),i.onabort=()=>o(i.error),i.onerror=()=>o(i.error),t(i.objectStore(this.storeName))}))))}}let Fr;function Ir(){return Fr||(Fr=new Cr),Fr}function Tr(e,t=Ir()){let r;return t.withIDBStore("readonly",(t=>{r=t.get(e)})).then((()=>r.result))}function Pr(e,t,r=Ir()){return r.withIDBStore("readwrite",(r=>{r.put(t,e)}))}function Nr(e){if(!/^[0-9A-Fa-f]{64}$/.test(e))throw new Error(`Invalid txId: ${e}`)}function Rr(e){if(!/^[0-9A-Fa-f]{64}:\d+$/.test(e))throw new Error(`Invalid outId: ${e}`)}function kr(e){Rr(e);const[t,r]=e.split(":");return{txId:t,virtualIndex:parseInt(r,10)}}class Mr{constructor(e=y.CHAIN,t=y.NETWORK,r=y.WOC_API_KEY){this.chain=e,this.network=t,"BSV"===e&&(this.wocApiKey=r),this.bcx=new P(this.getBaseUrl(),this.getRequestHeaders()),this.bbs=new P(y.UN_P2SH_URL),this.rawTxStore=new Cr("rawTxsDb","rawTxs"),this.outputDataStore=new Cr("outputDataDb","outputData")}getBaseUrl(){if("BSV"===this.chain)return"https://api.whatsonchain.com/v1/bsv/"+("livenet"===this.network?"main":"test");if("BCH"===this.chain)return`https://${"livenet"===this.network?"rest":"trest"}.bitcoin.com/v2`;throw new Error("Illegal state")}getRequestHeaders(){if("BSV"===this.chain)return this.wocApiKey?{"woc-api-key":this.wocApiKey}:{};if("BCH"===this.chain)return{};throw new Error("Illegal state")}getBalance(e){return a(this,void 0,void 0,(function*(){if("BSV"===this.chain){const t=yield this.bcx.get(`/address/${e.toString()}/balance`);return t.confirmed+t.unconfirmed}if("BCH"===this.chain){const t=yield this.bcx.get(`/address/details/${e.toString()}`);return t.balanceSat+t.unconfirmedBalanceSat}throw new Error("Illegal state")}))}getTransaction(e){return a(this,void 0,void 0,(function*(){return new F(yield this.getRawTransaction(e))}))}getRawTransaction(e){return a(this,void 0,void 0,(function*(){Nr(e);let t=yield Tr(e,this.rawTxStore);if(!t){const r="livenet"===this.network?"main":"test";t=yield this.bbs.get(`/tx/${this.chain}/${r}/${e}`),Pr(e,t,this.rawTxStore)}return t}))}getTransactions(e){return a(this,void 0,void 0,(function*(){return(yield this.getRawTransactions(e)).map((e=>new F(e)))}))}getRawTransactions(e){return a(this,void 0,void 0,(function*(){e.map(Nr);const t=Array();const r=new Array;for(let n=0;n<e.length;n+=1){const o=e[n];const i=yield Tr(o,this.rawTxStore);i?r.push([o,i]):t.push(o)}if(0===t.length)return r.map((e=>e[1]));const n="livenet"===this.network?"main":"test";const o=(yield this.bbs.post(`/tx-bulk/${this.chain}/${n}`,{txIds:t})).map(((e,r)=>[t[r],e]));const i=new Map(r.concat(o));return e.map((e=>i.get(e)))}))}sendTransaction(e){return a(this,void 0,void 0,(function*(){if("BSV"===this.chain)return this.bcx.post("/tx/raw",{txhex:e});if("BCH"===this.chain){const[t]=yield this.bcx.post("/rawtransactions/sendRawTransaction",{hexes:[e]});return t}throw new Error("Illegal state")}))}getUtxosFromAddress(e){return a(this,void 0,void 0,(function*(){if("BSV"===this.chain){const t=(yield this.bcx.get(`/address/${e.toString()}/unspent`)).map((e=>({txId:e.tx_hash,vout:e.tx_pos,amount:e.value/1e8,satoshis:e.value})));const r=[...new Set(t.map((e=>e.txId)))];const n=yield this.getTransactions(r);const o=new Map(n.map((e=>[e.id,e])));return Promise.all(t.map((e=>a(this,void 0,void 0,(function*(){const t=o.get(e.txId).outputs[e.vout].script.toHex();return Object.assign(Object.assign({},e),{scriptPubKey:t})})))))}if("BCH"===this.chain){const{utxos:t,scriptPubKey:r}=yield this.bcx.get(`/address/utxo/${e.toString()}`);return t.map((e=>({txId:e.txid,vout:e.vout,scriptPubKey:r,amount:e.amount,satoshis:e.satoshis,height:e.height,confirmations:e.confirmations})))}throw new Error("Illegal state")}))}getTxosFromOutputData(e){return a(this,void 0,void 0,(function*(){const t=e.map((e=>{const t=e.__txId;if(!t)throw new Error("Missing __txId");return t}));const r=[...new Set(t)];const n=yield this.getTransactions(r);const o=new Map(n.map((e=>[e.id,e])));return e.map((e=>{const t=e.__txId;if(!t)throw new Error("Missing __txId");const r=e.__vouts;if(!r)throw new Error("Missing __vouts");const n=o.get(t);if(!n)throw new Error("Illegal state");return r.map((e=>{const r=n.outputs[e];const o=r._scriptBuffer.toString("hex");const i=r._satoshis;return{txId:t,vout:e,scriptPubKey:o,satoshis:i,amount:i/1e8}}))}))}))}postOutputData(e){return a(this,void 0,void 0,(function*(){return this.bbs.post("/postOutputData",e)}))}getOutputData(e){return a(this,void 0,void 0,(function*(){let t=yield Tr(e,this.outputDataStore);function r(e){return new B(e)}return t||(t=yield this.bbs.get(`/un-p2sh/${e}`),Pr(e,t,this.outputDataStore)),t.map((e=>Object.assign(Object.assign({},e),{_owners:e._owners?e._owners.map(r):void 0})))}))}getOutputDatas(e){return a(this,void 0,void 0,(function*(){function t(e){return new B(e)}return(yield this.bbs.post("/un-p2sh-bulk",{txIds:e})).map((e=>e.map((e=>Object.assign(Object.assign({},e),{_owners:e._owners?e._owners.map(t):void 0})))))}))}getOwnedRevs(e){return a(this,void 0,void 0,(function*(){return this.bbs.get(`/txos/${e.toString()}`)}))}getLatestRev(e){return a(this,void 0,void 0,(function*(){Rr(e);const[{rev:t}]=yield this.bbs.get(`/get-rev/${e}`);return t}))}getLatestRevs(e){return a(this,void 0,void 0,(function*(){return e.map(Rr),e.map(Rr),yield this.bbs.post("/get-revs",{ids:e})}))}setTxoSpent(e){return a(this,void 0,void 0,(function*(){const t=kr(e);this.bbs.post("/txos/set-spent/",t)}))}}function Ur(e,t){const r=[];let n=0;for(;n<e.length;){const o=n+t;r.push(e.slice(n,o)),n=o}return r}function $r(e,t){const r=t.length;if(r>16)throw new Error("Too many owners");const n=new C;n.add("OP_1");for(const e of t)n.add(e.toBuffer());return n.add(`OP_${r}`),n.add("OP_CHECKMULTISIG"),n.add(e),n.add("OP_DROP"),n}function Kr(e){const t=e.chunks.length;return!!(t>=5&&e.chunks[0].opcodenum===S.OP_1&&e.chunks[1].buf&&[20,33].includes(e.chunks[1].buf.length)&&e.chunks[t-3].opcodenum===S.OP_CHECKMULTISIG&&e.chunks[t-2].buf&&e.chunks[t-1].opcodenum===S.OP_DROP)}function Vr(e){const{_owners:t,_amount:r,__vouts:n,__txId:o}=e,i=u(e,["_owners","_amount","__vouts","__txId"]);const a=Ur(Buffer.from(JSON.stringify(i)),y.SCRIPT_CHUNK_SIZE);if(a[a.length-1].byteLength>=y.SCRIPT_CHUNK_SIZE){const e=a.pop();if(!e)throw new Error("Illegal state");const t=Ur(e,y.SCRIPT_CHUNK_SIZE);for(const e of t)a.push(e)}return a.map((e=>({redeemScript:$r(e,t||[]),chunk:e})))}function qr(e){if(Kr(e))return e.chunks.slice(1,e.chunks.length-4).map((e=>{if(!e.buf)throw new Error("Illegal state");return new B(e.buf)}));throw new Error("Cannot get owners from non-data script")}function Lr(e){if(Kr(e)){const t=e.chunks[e.chunks.length-2];if(!t.buf)throw new Error("Illegal state");return JSON.parse(t.buf.toString())}return{}}function Hr(e){return!(3!==e.chunks.length||e.chunks[0].opcodenum!==S.OP_0||!e.chunks[1].buf||!e.chunks[2].buf)}function Wr(e){if(!Hr(e))throw new Error("not a p2sh script");return new C(e.chunks[2].buf)}function Gr(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r+=1)if(e[r]!==t[r])return!1;return!0}function Jr(e){return new Promise((t=>setTimeout(t,e)))}function zr(e){const t=e.map((e=>{const t=e.chunks[e.chunks.length-2];if(!t.buf)throw new Error("Illegal state");return t.buf}));const r=Buffer.concat(t);const n=JSON.parse(r.toString());return Object.assign({_owners:qr(e[0]),_amount:y.MIN_NON_DUST_AMOUNT},n)}function Yr(e){const t=[];let r=0;return e.forEach((e=>{const n=[];const o=Vr(e).length;for(let e=0;e<o;e+=1)n.push(r),r+=1;const i=Object.assign({},e);i.__vouts=n,t.push(i)})),t}class Zr{constructor(e,t,r){const n=new F(r);n.feePerKb(y.DEFAULT_FEE),this.restClient=new Mr(e,t),this._tx=n,this._outputData=[]}get chain(){return this.restClient.chain}get network(){return this.restClient.network}get dataInputs(){const e=[];for(let t=0;t<this.tx.inputs.length;t+=1){const r=this.tx.inputs[t];const n=new C(r._scriptBuffer);if(Hr(n)){const r=[Wr(n)];for(;;)try{const t=zr(r);e.push(t);break}catch(e){if(t+=1,t===this.tx.inputs.length)throw new Error("Could not compute data inputs");const n=this.tx.inputs[t];const o=new C(n._scriptBuffer);r.push(Wr(o))}}}return e}getVirtualInputs(){return a(this,void 0,void 0,(function*(){if("BSV"===this.chain)return(yield Promise.all(this.tx.inputs.map((e=>a(this,void 0,void 0,(function*(){const{outputIndex:t}=e;const r=e.prevTxId.toString("hex");const n=new Zr(this.chain,this.network);yield n.fromTxId(r);const o=n.tx.outputs[t];return Kr(new C(o._scriptBuffer))?e:null})))))).filter((e=>null!==e)).map((e=>{if(null===e)throw new Error("Illegal state");return`${e.prevTxId.toString("hex")}:${e.outputIndex}`}));if("BCH"===this.chain){const e=Yr(this.dataInputs);return Promise.all(e.map((e=>a(this,void 0,void 0,(function*(){const t=[];e.__vouts&&e.__vouts.forEach((e=>{t.push(this.tx.inputs[e])}));const r=t[0].prevTxId.toString("hex");const n=new Zr(this.chain,this.network);yield n.fromTxId(r),yield n.fetchOutputData();const o=Yr(n.outputData);const i=[];return o.forEach(((e,r)=>{Gr(e.__vouts||[],t.map((e=>e.outputIndex)))&&i.push(r)})),`${r}:${i[0]}`})))))}throw new Error("Illegal state")}))}fromDataOutput(e,t){const r=Vr(t);const{_owners:n}=t;return r.forEach((({redeemScript:t},r)=>{const{scriptPubKey:o,satoshis:i,txId:u,vout:a}=e[r];const s=new D({script:new C(o),satoshis:i});const c=new C;const l=new E({prevTxId:u,output:s,outputIndex:a,script:c},n||[],1,null,t);this.tx.addInput(l)})),this}get tx(){return this._tx}get outputData(){if("BSV"===this.chain)return this.tx.outputs.filter((e=>Kr(new C(e._scriptBuffer)))).map((e=>{const{chunks:t}=e._script||e.script;const{buf:r}=t[t.length-2];if(!r)throw new Error("Illegal state");const n=JSON.parse(r.toString());const o=t.slice(1,t.length-4);return n._owners=o.map((e=>{if(!e.buf)throw new Error("Illegal state");return new B(e.buf)})),n._amount=e._satoshis,n}));if("BCH"===this.chain)return this._outputData;throw new Error("Illegal state")}toData(e){if("BSV"===this.chain){const{_owners:t,_amount:r}=e,n=u(e,["_owners","_amount"]);const o=$r(Buffer.from(JSON.stringify(n)),t||[]);const i=new D({script:o,satoshis:r||0});return this.tx.addOutput(i),this.tx.outputs.length-1}if("BCH"===this.chain){const t=Vr(e);return this._outputData.push(e),t.forEach((({redeemScript:t})=>{const r=C.buildScriptHashOut(t);const n=e._amount||0;const o=new D({script:r,satoshis:n});this.tx.addOutput(o)})),this._outputData.length-1}throw new Error("Illegal state")}fetchOutputData(){return a(this,void 0,void 0,(function*(){if(this._outputData.length>0)return;const e=this.getTxId();if("BSV"!==this.chain){if("BCH"!==this.chain)throw new Error("Illegal state");this._outputData=yield this.restClient.getOutputData(e)}else this._outputData=this.tx.outputs.map((e=>{const t=new C(e._scriptBuffer);const r=e._satoshis;if(Kr(t)){const e=Lr(t);return e._owners=qr(t),e._amount=r,e}if(t.isPublicKeyHashOut()){const e=t.getPublicKeyHash();return{address:b.fromPublicKeyHash(e)}}throw new Error(`Unrecognized output script ${t.toString()}`)}))}))}getTxId(){return new _(this.tx._getHash()).readReverse().toString("hex")}fromTxId(e){return a(this,void 0,void 0,(function*(){let t;try{t=yield this.restClient.getRawTransaction(e)}catch(r){yield Jr(3e3),t=yield this.restClient.getRawTransaction(e)}return this.tx.fromString(t),this}))}}const Xr=()=>`__temp__:${Math.random()}`;const Qr=["_id","_rev","_owners","_amount","__vouts","__txId","__cls","__func","__index","__args"];const en=e=>(Object.prototype.toString.call(e).match(/\s([a-zA-Z]+)/)||[])[1];const tn=e=>"object"==typeof e?en(e):en(e).toLowerCase();const rn=e=>["number","string","boolean","undefined","Null"].includes(tn(e));const nn=e=>"Array"===tn(e);const on=e=>"Object"===tn(e);const un=e=>!!e._owners&&"string"==typeof e._owners;const an=e=>rn(e)||["Array","Object"].includes(tn(e));const sn=e=>"Object"===tn(e)&&Object.keys(e).every((e=>!Number.isNaN(parseInt(e,10))));const cn=(e,t)=>{if(!an(e)||!an(t))throw new Error(`Unsupported data types for deep equals: ${tn(e)} & ${tn(t)}`);if(tn(e)!==tn(t))return!1;if(rn(e)&&rn(t))return e===t;const r=(e,t)=>Object.entries(e).every((([e,r])=>cn(t[e],r)));return e&&t&&r(e,t)&&r(t,e)};const ln=e=>{if(rn(e))return e;if(nn(e))return e.map(ln);if(on(e)){const t=Object.keys(e).reduce(((t,r)=>(t[r]=ln(e[r]),t)),{});const r=Object.create(Object.getPrototypeOf(e));return Object.assign(r,t)}throw new Error(`Unsupported data type for clone: ${tn(e)}`)};const fn=(e,t)=>e.reduce((([e,r],n,o)=>t(n,o)?[[...e,n],r]:[e,[...r,n]]),[[],[]]);const dn=(e,t)=>Object.fromEntries(Object.entries(e).map((e=>t(e))));const hn=(e,t)=>dn(e,(([e,r])=>[e,t(r)]));const pn=(e,t)=>Object.fromEntries(Object.entries(e).filter((([,e])=>t(e))));const vn=(e,t,r,n)=>{if(rn(e))return e;if(nn(e))return e.map((e=>vn(e,t,r,n)));if(on(e)){e._rev=`${n}:${r}`;const o=t[r];return Object.entries(e).forEach((([r,i])=>{"object"==typeof o&&Object.keys(o).includes(r)&&(e[r]=vn(i,t,o[r],n))})),e}throw new Error(`Unsupported type ${tn(e)} in deep.updateRev`)};const yn=e=>{if(rn(e))return e;if(nn(e))return e.map((e=>yn(e)));if(on(e))return e.__cls=e.constructor.toString(),Object.entries(e).forEach((([t,r])=>{e[t]=yn(r)})),e;throw new Error(`Unsupported type ${tn(e)} in deep.addClass`)};const bn=(e,t)=>{if(rn(e))return e;if(nn(e))return e.map((e=>bn(e,t)));if(on(e))return e._id=!e._id||e._id.startsWith("__temp__")?e._rev:e._id,e._rootId=e._rootId||t,Object.entries(e).forEach((([r,n])=>{e[r]=bn(n,t)})),e;throw new Error(`Unsupported type ${tn(e)} in deep.addId`)};const wn=e=>{if(rn(e))return e;if(nn(e))return e.map((e=>wn(e)));if(on(e)){const t=Xr();return e._id=e._id||t,e._rev=e._rev||t,Object.values(e).map((e=>wn(e))),e}throw new Error(`Unsupported type ${tn(e)} in addRandomId`)};const _n=e=>{if(rn(e))return e;if(nn(e))return e.map((e=>_n(e)));if(on(e))return dn(e,(([e,t])=>"_owners"===e?[e,JSON.stringify(t)]:rn(t)?[e,t]:[e,_n(t)]));throw new Error(`Unexpected type ${tn(e)} in stringifyOwners`)};const gn=e=>un(e)?Object.assign(Object.assign({},e),{_owners:JSON.parse(e._owners).map((e=>new B(e)))}):e;const mn=e=>{if(rn(e))return e;if(nn(e)||on(e))return Object.entries(e).reduce(((e,[t,r])=>{const n=mn(r);return sn(n)?Object.entries(n).forEach((([r,n])=>{e[`${t}_${r}`]=n})):e[t]=n,e}),{});throw new Error(`Unsupported type ${tn(e)} in encodeArraysAsObjects`)};const An=e=>{const t={[e._id]:Object.entries(e).reduce(((e,[t,r])=>Qr.includes(t)?Object.assign(Object.assign({},e),{[t]:r}):rn(r)?Object.assign(Object.assign({},e),{[`__basic__${t}`]:r}):Object.assign(Object.assign({},e),{[t]:r._id})),{})};return Object.values(e).filter((e=>!rn(e))).reduce(((e,t)=>Object.assign(Object.assign({},e),An(t))),t)};const En=e=>Object.fromEntries(Object.entries(e).filter((([e])=>!e.startsWith("__basic__"))));const On=(e,t)=>Object.fromEntries(Object.entries(t).map((([t,r])=>{const n=e[t];var o;return r.__change=(o=n)?cn(o,r)?"same":"diff":"new",[t,r]})));const Sn=(e,t)=>(e[t].__contains=Object.entries(e[t]).reduce(((t,[r,n])=>["__contains"].concat(Qr).includes(r)?t:"__change"===r?"new"===n||"diff"===n||t:Sn(e,n)[n].__contains||t),!1),e);const jn=e=>e.reduce(((e,t,r)=>Object.assign(Object.assign({},e),{[t._id]:r})),{});const Dn=(e,t)=>e.map((e=>Object.entries(e).reduce(((e,[r,n])=>{const o="string"==typeof n&&"undefined"!==tn(t[n])?t[n]:n;return Object.assign(Object.assign({},e),{[r]:o})}),{})));const xn=(e,t,r)=>{const[n,...o]=[t,...e].map(((e,t)=>{const n=u(e,["_id","_rev","__change","__contains"]);return 0===t||t<=r.length?u(n,["__cls"]):n}));return[n,...o.map((e=>Object.fromEntries(Object.entries(e).filter((([e,t])=>Qr.filter((e=>"__cls"!==e)).includes(e)||"__cls"===e&&"string"==typeof t&&"function Object() { [native code] }"!==t||"number"==typeof t)))))]};const Bn=(e,t)=>{const r=wn(t);const n=r._id;const o=ln(e);const i=ln(r);yn(o),yn(i);const u=_n(o);const a=_n(i);const s=mn(u);const c=mn(a);const l=An(s);const f=An(c);const d=On(l,f);const h=hn(d,En);const p=Sn(h,n);const v=p[n];delete v.__cls,delete p[n];const y=hn(p,(e=>e._rev));const b=pn(p,(e=>e.__contains||Object.values(v).includes(e._id)));const w=Object.values(b);const[_,g]=fn(w,(e=>"new"===e.__change));const m=[...g,..._];const A=jn(m);const E=Dn(m,A);const[O]=Dn([v],A);const S=g.map((e=>e._rev));const[j,...D]=xn(E,O,S);return[S,D.map(gn).map((e=>Object.entries(e).reduce(((e,[t,r])=>Object.assign(Object.assign({},e),{[t]:y[r]||r})),{}))),j]};function Cn(e,t){let r=0;return t.map((t=>"__"===t?e[r++]:t))}class Fn{constructor(e,t){this.chain=e,this.network=t}get(e){return a(this,void 0,void 0,(function*(){const{txId:t,virtualIndex:r}=kr(e);const n=new Zr(this.chain,this.network);yield n.fromTxId(t),yield n.fetchOutputData();const o=yield n.getVirtualInputs();const i=n.outputData;const u=i[0].__index||{};const a=i[u.obj].__cls||"";const s=i[u.obj].__func||"";const c=i[u.obj].__args||[];const l=yield Promise.all(Object.values(u).map((e=>{const t=o[e];return t?this.get(t):Promise.resolve({})})));const f=Object.keys(u).map(((e,t)=>[e,l[t]]));const d=Object.fromEntries(f);let h=d.obj;delete d.obj;const p=Object.entries(d).reduce(((e,[t,r])=>{const n=parseInt(t,10);return Number.isNaN(n)||(e[n]=r),e}),[]);const v=Cn(p,c);let y;if("constructor"===s){const e=eval(`(${a})`);h=Reflect.construct(e,v)}else y=Reflect.apply(h[s].bind(h),h,v);Object.entries(u).forEach((([e,r])=>{const n=parseInt(e,10);let o=p[n];"obj"===e?o=h:"res"===e&&(o=y),vn(o,i,r,t)}));const b=h._rootId||`${t}:${u.obj}`;return bn([y,h,...p],b),[...p,h,y][r]}))}}function In(e){return e.map((e=>{const{_owners:t}=e,r=u(e,["_owners"]);const n=Object.assign({},r);return t&&(n._owners=t.map((e=>"string"==typeof e?new B(e):e))),n}))}function Tn(e,t,r){const n=Object.assign({},e);return n._owners||(n._owners=t),n._amount||(n._amount=r),n}class Pn{constructor(e){this.wallet=e}get chain(){return this.wallet.chain}get network(){return this.wallet.network}put(e){return this.update([],e)}getTransactions(e){return a(this,void 0,void 0,(function*(){return yield this.wallet.restClient.getTransactions(e)}))}getOutputData(e){return a(this,void 0,void 0,(function*(){const t=[...new Set(e)];const r=yield this.wallet.restClient.getOutputDatas(t);const n=new Map(r.map(((e,r)=>[t[r],e])));const o=new Map;return yield Promise.all(t.map((e=>a(this,void 0,void 0,(function*(){const t=Yr(n.get(e));for(let r=0;r<t.length;r+=1)t[r].__txId=e;o.set(e,t)}))))),e.map((e=>{const t=o.get(e);if(!t)throw new Error("Illegal state");return t}))}))}get(e){return a(this,void 0,void 0,(function*(){const t=e.map(kr);const r=t.map((e=>e.txId));if("BSV"===this.chain){const e=yield this.getTransactions(r);return t.map(((t,r)=>{const{txId:n,virtualIndex:o}=t;const i=e[r].outputs[o];const u=new C(i.script);const a=Math.round(i.satoshis);const s=Lr(u);const c=qr(u);const l=[o];return s.__txId=n,s.__vouts=l,s._owners=c,s._amount=a,s}))}if("BCH"===this.chain){const e=yield this.getOutputData(r);return t.map(((t,r)=>{const{virtualIndex:n}=t;return e[r][n]}))}throw new Error("Illegal state")}))}prepareTransactionFromBsv(e,t){return a(this,void 0,void 0,(function*(){const r=t.map(kr);const n=r.map((e=>e.txId));const o=yield this.getTransactions(n);r.forEach(((t,r)=>{const{txId:n,virtualIndex:i}=t;const u=o[r].outputs[i];const a=new C(u.script);const s=Math.round(u.satoshis);const c=qr(a);const l={txId:n,outputIndex:i,scriptPubKey:a,satoshis:s};e.tx.from(l,c,1)}))}))}prepareTransactionFromBch(e,t){return a(this,void 0,void 0,(function*(){const r=yield this.get(t);const n=yield this.wallet.restClient.getTxosFromOutputData(r);r.forEach(((t,r)=>{e.fromDataOutput(n[r],t)}))}))}getUpdateTx(e,t){return a(this,void 0,void 0,(function*(){const r=new Zr(this.chain,this.network);if("BSV"===this.chain)yield this.prepareTransactionFromBsv(r,e);else{if("BCH"!==this.chain)throw new Error("Illegal state");yield this.prepareTransactionFromBch(r,e)}const n=[this.wallet.getPublicKey()];const o=y.MIN_NON_DUST_AMOUNT;const i=t.map((e=>Tn(e,n,o))).map((e=>r.toData(e)));return{txId:yield this.wallet.fundAndSendTransaction(r,!0),virtualIndices:i}}))}update(e,t){return a(this,void 0,void 0,(function*(){const{txId:r,virtualIndices:n}=yield this.getUpdateTx(e,t);return n.map((e=>`${r}:${e}`))}))}}function Nn(e){return{smartArgs:e.filter((e=>e._rev)),dumbArgs:e.map((e=>e._rev?"__":e))}}function Rn(e){return a(this,void 0,void 0,(function*(){let t;let r;let n;let o;let i;let u;let a;if("Cls"in e){const{Cls:s,args:c}=e;t=s.toString(),r=null,n=Reflect.construct(s,c),o=ln(c),i=c,u=null,a=void 0}else{const{target:s,property:c,args:l}=e;t=null,r=ln(s),n=s,o=ln(l),i=l,u=c,a=Reflect.apply(s[c],s,i)}const{smartArgs:s,dumbArgs:c}=Nn(o);const{smartArgs:l}=Nn(i);const f=Object.assign(Object.assign(Object.assign({},s),{obj:r}),{_id:"index"});const d=Object.assign(Object.assign(Object.assign({},l),{obj:n}),{_id:"index"});"Object"===tn(a)&&(d.res=a);const[h,p,v]=Bn(f,d);void 0!==p[0]&&(p[0].__index=v);const y=v.obj;return void 0!==p[y]&&(null!==t&&(p[y].__cls=t),p[y].__func=null===u?"constructor":String(u),p[y].__args=c),[h,p,n,l,a,v]}))}class kn{constructor(e){this.db=e}construct(e,t){return a(this,void 0,void 0,(function*(){const[r,n,o,i,,u]=yield Rn({Cls:e,args:t});const[a]=yield this.db.update(r,In(n));const{txId:s}=kr(a);Object.entries(u).forEach((([e,t])=>{const r=parseInt(e,10);let u=i[r];"obj"===e&&(u=o),vn(u,n,t,s)}));const c=`${s}:${u.obj}`;return bn([o,...i],c),o}))}call(e,t,r){return a(this,void 0,void 0,(function*(){const[n,o,,i,u,a]=yield Rn({target:e,property:t,args:r});const[s]=yield this.db.update(n,In(o));const{txId:c}=kr(s);Object.entries(a).forEach((([t,r])=>{const n=parseInt(t,10);let a=i[n];"obj"===t?a=e:"res"===t&&(a=u),vn(a,o,r,c)}));const l="string"==typeof e._rootId?e._rootId:`${c}:${a.obj}`;return bn([u,e,...i],l),u}))}get(e,t){return"function"==typeof e[t]?(...r)=>this.call(e,t,r):Reflect.get(e,t)}}function Mn(e){const t=e;for(let e=t.length-1;e>0;e-=1){const r=Math.floor(Math.random()*(e+1));[t[e],t[r]]=[t[r],t[e]]}}class Un{constructor(e,t,r={}){const{path:n="m/44'/0'/0'/0",passphrase:o=""}=r;let i=e.toHDPrivateKey(o,y.NETWORK);n&&(i=i.derive(n));const u=i.publicKey.toAddress(t.network);this.mnemonic=e,this.restClient=t,this.path=n,this.passphrase=o,this.hdPrivateKey=i,this.address=u,this.utxos=[],this.utoxsSyncing=!1,this.syncUtxos()}get chain(){return this.restClient.chain}get network(){return this.restClient.network}getMnemonic(){return this.mnemonic}getPath(){return this.path}getUtxos(){return this.utxos}derive(e="0"){const t=`${this.path}${this.path.length>0?"/":""}${e}`;return new Un(this.mnemonic,this.restClient,{path:t})}getPrivateKey(){return this.hdPrivateKey.privateKey}getPublicKey(){return this.hdPrivateKey.publicKey}getAddress(){return this.address}syncUtxos(){return a(this,void 0,void 0,(function*(){this.utoxsSyncing=!0,this.utxos=yield this.restClient.getUtxosFromAddress(this.getAddress()),this.utoxsSyncing=!1}))}waitUntilSynced(){return a(this,void 0,void 0,(function*(){for(;this.utoxsSyncing;)yield Jr(300)}))}getBalance(){return a(this,void 0,void 0,(function*(){return this.restClient.getBalance(this.getAddress())}))}getBalanceLowerBounds(){return a(this,void 0,void 0,(function*(){return yield this.waitUntilSynced(),this.utxos.reduce(((e,t)=>e+t.satoshis),0)}))}getUtxosToSpend(e){return a(this,void 0,void 0,(function*(){return yield this.waitUntilSynced(),Mn(this.utxos),this.getUtxosWithSatoshis(e)}))}getUtxosWithSatoshis(e){let t=0;const r=[];for(let n=0;n<this.utxos.length;n+=1){const o=this.utxos[n];if(t+=o.satoshis,r.push(o),t>=e)return r}throw new Error(`Insufficient balance in address ${this.getAddress().toString()} on ${y.NETWORK} ${y.CHAIN}. Found ${t}, required ${e}.`)}fundAndSendTransaction(e,t=!1){return a(this,void 0,void 0,(function*(){e.tx.feePerKb(y.DEFAULT_FEE);const r=e.tx._getInputAmount();let n=[];const o=e.tx._getOutputAmount()-r+(e.tx._estimateFee()+100);o>0&&(n=yield this.getUtxosToSpend(o),n.forEach((t=>{const{amount:r,satoshis:n,scriptPubKey:o,txId:i,vout:u}=t;e.tx.from({amount:r,satoshis:n,scriptPubKey:o,txId:i,vout:u})}))),e.tx.change(this.getAddress()),e.tx.sign(this.getPrivateKey());const i=yield this.restClient.sendTransaction(e.tx.toString());t&&(yield this.storeResult(i,e)),this.utxos=this.utxos.slice(n.length);const u=e.tx.getChangeOutput();if(u){const t=e.tx._changeIndex;const{satoshis:r}=u;const n=r/1e8;const o=u.script.toHex();this.utxos.push({txId:i,vout:t,satoshis:r,amount:n,scriptPubKey:o})}return i}))}storeResult(e,t){return a(this,void 0,void 0,(function*(){function r(e){return e.toString()}const n=t.outputData.map((e=>Object.assign(Object.assign({},e),{_owners:e._owners?e._owners.map(r):void 0})));const o=JSON.stringify(n);const i=t.tx.toJSON().inputs.map((e=>`${e.prevTxId}:${e.outputIndex}`));yield this.restClient.postOutputData({txId:e,outputData:o,inputs:i})}))}send(e,t){return a(this,void 0,void 0,(function*(){const r=new Zr(this.chain,this.network);return r.tx.to(t,e),this.fundAndSendTransaction(r)}))}}class $n{constructor(e={}){const t=e.chain||y.CHAIN;const r=e.network||y.CHAIN;const n=e.mnemonic||new m(e.seed);const o=e.path||"m/44'/0'/0'/0";const i=e.passphrase||"";if(!["BSV","BCH"].includes(t))throw new Error("Please set 'chain' to 'BSV' or 'BCH' when creating a computer instance");if(!["livenet","testnet"].includes(r))throw new Error("Please set 'network' to 'testnet' or 'livenet' when creating a computer instance");const u=new Mr(t,r,e.wocApiKey);const a=e.db||new Pn(new Un(n,u,{path:o,passphrase:i}));this.db=a}get chain(){return this.db.chain}get network(){return this.db.network}parseContract(e){const t=e.startsWith("export ")?e.slice(7):e;const r=t.startsWith("default ")?t.slice(8):t;return eval(`(${r})`)}new(e,t){return a(this,void 0,void 0,(function*(){const r=e.toString();const n=yield this.parseContract(r);const o=new kn(this.db);const i=yield o.construct(n,t);return new Proxy(i,o)}))}sync(e){return a(this,void 0,void 0,(function*(){Rr(e);const t=new Fn(this.chain,this.network);const r=new kn(this.db);const n=yield t.get(e);return new Proxy(n,r)}))}getOwnedRevs(e=this.db.wallet.getPublicKey()){return this.db.wallet.restClient.getOwnedRevs(e)}getRevs(e=this.db.wallet.getPublicKey()){return a(this,void 0,void 0,(function*(){return(yield this.getOwnedRevs(e)).map((({txId:e,virtualIndex:t})=>`${e}:${t}`))}))}getLatestRev(e){return this.db.wallet.restClient.getLatestRev(e)}getLatestRevs(e){return this.db.wallet.restClient.getLatestRevs(e)}}var Kn=(e,t,r)=>{const n=new Zr(e,t,r);const o=n.getTxId();function i(e){return e.toString()}const u=n.outputData.map((e=>Object.assign(Object.assign({},e),{_owners:e._owners?e._owners.map(i):void 0})));return{txId:o,outputData:JSON.stringify(u),inputs:n.tx.toJSON().inputs.map((e=>`${e.prevTxId}:${e.outputIndex}`))}};e.Computer=$n,e.parseOutputData=Kn,Object.defineProperty(e,"__esModule",{value:!0})}));
